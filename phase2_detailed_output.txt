NHS Cancer Performance Data - Phase 2: Processing Accuracy Validation
================================================================================
Loaded 157 trust mappings from database

🧪 Starting Phase 2: Cancer Data Processing Accuracy
📂 Data directory: /Users/markknapp/Desktop/Projects/NHS-Data-Analytics-Tool-v6-master/Data
📋 Files to process: 3

🔄 Test 1: Processing Pipeline Integrity
  🔄 Processing CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx...

Processing file: CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61780 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP']
Determined period: 2024-Q1 (2024-04-01)
Found 147 R-code trusts out of 166 total
Processing R0A: 567 records
Processing R0D: 562 records
Processing R1F: 465 records
Processing R1H: 540 records
Processing R1K: 488 records
Processing RA2: 542 records
Processing RA9: 490 records
Processing RAE: 521 records
Processing RAJ: 559 records
Processing RAS: 416 records
Processing RAX: 445 records
Processing RBD: 471 records
Processing RBK: 374 records
Processing RBN: 505 records
Processing RBT: 461 records
Processing RC9: 532 records
Processing RCB: 512 records
Processing RCD: 476 records
Processing RCF: 425 records
Processing RCX: 452 records
Processing RD1: 537 records
Processing RD8: 522 records
Processing RDE: 560 records
Processing RDU: 551 records
Processing REF: 570 records
Processing REM: 475 records
Processing RF4: 523 records
Processing RFF: 434 records
Processing RFR: 444 records
Processing RFS: 470 records
Processing RGN: 510 records
Processing RGP: 463 records
Processing RGR: 462 records
Processing RGT: 553 records
Processing RH5: 549 records
Processing RH8: 552 records
Processing RHM: 566 records
Processing RHQ: 566 records
Processing RHU: 555 records
Processing RHW: 543 records
Processing RJ1: 562 records
Processing RJ2: 471 records
Processing RJ6: 440 records
Processing RJ7: 523 records
Processing RJC: 460 records
Processing RJE: 572 records
Processing RJL: 421 records
Processing RJN: 344 records
Processing RJZ: 531 records
Processing RK5: 413 records
Processing RK9: 579 records
Processing RKB: 553 records
Processing RKE: 386 records
Processing RL4: 549 records
Processing RLQ: 381 records
Processing RLT: 376 records
Processing RM1: 514 records
Processing RMC: 445 records
Processing RMP: 392 records
Processing RN3: 508 records
Processing RN5: 528 records
Processing RN7: 407 records
Processing RNA: 511 records
Processing RNN: 421 records
Processing RNQ: 463 records
Processing RNS: 536 records
Processing RNZ: 492 records
Processing RP5: 473 records
Processing RPA: 447 records
Processing RPY: 479 records
Processing RQM: 475 records
Processing RQW: 444 records
Processing RQX: 406 records
Processing RR7: 432 records
Processing RR8: 568 records
Processing RRF: 466 records
Processing RRK: 557 records
Processing RRV: 553 records
Processing RTD: 587 records
Processing RTE: 540 records
Processing RTF: 450 records
Processing RTG: 557 records
Processing RTH: 564 records
Processing RTK: 432 records
Processing RTP: 489 records
Processing RTR: 526 records
Processing RTX: 513 records
Processing RVJ: 463 records
Processing RVV: 558 records
Processing RVW: 454 records
Processing RWA: 523 records
Processing RWD: 540 records
Processing RWE: 542 records
Processing RWF: 534 records
Processing RWG: 485 records
Processing RWH: 528 records
Processing RWP: 523 records
Processing RWY: 510 records
Processing RX1: 562 records
Processing RXC: 484 records
Processing RXF: 515 records
Processing RXK: 433 records
Processing RXL: 463 records
Processing RXN: 538 records
Processing RXP: 441 records
Processing RXQ: 482 records
Processing RXR: 549 records
Processing RXW: 535 records
Processing RYJ: 563 records
Processing RYR: 580 records
Processing RWW: 402 records
Processing RAL: 522 records
Processing RBL: 461 records
Processing RJR: 450 records
Processing RA7: 509 records
Processing RAP: 460 records
Processing REP: 104 records
Processing RM3: 501 records
Processing RQ3: 121 records
Processing RVR: 350 records
Processing RWJ: 381 records
Processing R0B: 466 records
Processing RBQ: 135 records
Processing RET: 63 records
Processing RP6: 72 records
Processing RAN: 125 records
Processing RBS: 64 records
Processing RCU: 44 records
Processing RPC: 159 records
Processing RRJ: 88 records
Processing RY2: 58 records
Processing RBV: 451 records
Processing REN: 412 records
Processing RPG: 2 records
Processing RX2: 13 records
Processing RL1: 67 records
Processing RXY: 1 records
Processing RGM: 90 records
Processing RP4: 51 records
Processing R1L: 4 records
Processing RYX: 2 records
Processing RX3: 2 records
Processing RT1: 4 records
Processing RV9: 4 records
Processing RQY: 2 records
Processing RWK: 4 records
Processing RXV: 2 records
Successfully processed 147 trusts
    ✅ Success: 147 trusts processed in 5.70s
  🔄 Processing CWT-CRS-Oct-2024-to-Mar-2025-Data-Extract-Provider.xlsx...

Processing file: CWT-CRS-Oct-2024-to-Mar-2025-Data-Extract-Provider.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61649 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['OCT', 'NOV', 'DEC', 'JAN', 'FEB', 'MAR']
Determined period: 2025-Q3 (2025-10-01)
Found 144 R-code trusts out of 158 total
Processing R0A: 572 records
Processing R0D: 560 records
Processing R1F: 445 records
Processing R1H: 557 records
Processing RA2: 543 records
Processing RA9: 505 records
Processing RAE: 522 records
Processing RAJ: 563 records
Processing RAP: 226 records
Processing RAS: 400 records
Processing RAX: 436 records
Processing RBD: 439 records
Processing RBK: 382 records
Processing RBN: 501 records
Processing RBT: 450 records
Processing RC9: 534 records
Processing RCB: 510 records
Processing RCD: 479 records
Processing RCF: 432 records
Processing RCX: 420 records
Processing RD1: 538 records
Processing RD8: 513 records
Processing RDU: 552 records
Processing REF: 569 records
Processing REM: 481 records
Processing RF4: 542 records
Processing RFF: 450 records
Processing RFR: 460 records
Processing RFS: 468 records
Processing RGN: 513 records
Processing RGP: 475 records
Processing RGR: 471 records
Processing RGT: 554 records
Processing RH5: 561 records
Processing RH8: 544 records
Processing RHM: 572 records
Processing RHQ: 578 records
Processing RHU: 561 records
Processing RHW: 551 records
Processing RJ1: 551 records
Processing RJ2: 462 records
Processing RJ6: 427 records
Processing RJ7: 533 records
Processing RJC: 467 records
Processing RJE: 570 records
Processing RJL: 418 records
Processing RJN: 339 records
Processing RJZ: 530 records
Processing RK5: 429 records
Processing RK9: 573 records
Processing RKB: 558 records
Processing RKE: 378 records
Processing RL4: 544 records
Processing RLQ: 409 records
Processing RLT: 383 records
Processing RM1: 510 records
Processing RMC: 450 records
Processing RMP: 391 records
Processing RN5: 531 records
Processing RN7: 410 records
Processing RNA: 501 records
Processing RNN: 421 records
Processing RNQ: 479 records
Processing RNS: 526 records
Processing RNZ: 469 records
Processing RP5: 470 records
Processing RPA: 447 records
Processing RPY: 475 records
Processing RQM: 494 records
Processing RQW: 439 records
Processing RQX: 395 records
Processing RR7: 441 records
Processing RR8: 566 records
Processing RRF: 459 records
Processing RRK: 565 records
Processing RRV: 550 records
Processing RTD: 592 records
Processing RTE: 550 records
Processing RTF: 463 records
Processing RTG: 561 records
Processing RTH: 574 records
Processing RTK: 432 records
Processing RTP: 496 records
Processing RTR: 536 records
Processing RTX: 507 records
Processing RVJ: 485 records
Processing RVV: 560 records
Processing RVW: 464 records
Processing RWA: 529 records
Processing RWD: 542 records
Processing RWF: 541 records
Processing RWG: 475 records
Processing RWH: 523 records
Processing RWP: 515 records
Processing RWW: 404 records
Processing RWY: 530 records
Processing RX1: 566 records
Processing RXC: 494 records
Processing RXF: 528 records
Processing RXK: 446 records
Processing RXL: 452 records
Processing RXN: 535 records
Processing RXP: 453 records
Processing RXQ: 485 records
Processing RXR: 533 records
Processing RXW: 544 records
Processing RYJ: 553 records
Processing RYR: 582 records
Processing R1K: 482 records
Processing RAL: 532 records
Processing RBL: 472 records
Processing REP: 98 records
Processing RN3: 497 records
Processing RDE: 554 records
Processing RJR: 451 records
Processing RWE: 546 records
Processing RA7: 523 records
Processing RM3: 517 records
Processing RQ3: 107 records
Processing RWJ: 375 records
Processing R0B: 472 records
Processing RBQ: 130 records
Processing RVR: 366 records
Processing RET: 65 records
Processing RAN: 114 records
Processing RBS: 44 records
Processing RCU: 46 records
Processing RPC: 158 records
Processing RRJ: 85 records
Processing RY2: 64 records
Processing RBV: 456 records
Processing REN: 411 records
Processing RL1: 79 records
Processing RP6: 72 records
Processing RGM: 97 records
Processing RP4: 58 records
Processing RXV: 2 records
Processing R1D: 4 records
Processing RYX: 2 records
Processing R1A: 4 records
Processing RX2: 4 records
Processing RDR: 1 records
Processing RWK: 2 records
Processing RMY: 2 records
Successfully processed 144 trusts
    ✅ Success: 144 trusts processed in 5.61s
  🔄 Processing CWT-CRS-Apr-2025-to-Jul-2025-Data-Extract-Provider.xlsx...

Processing file: CWT-CRS-Apr-2025-to-Jul-2025-Data-Extract-Provider.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 41013 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['APR', 'MAY', 'JUN', 'JUL']
Determined period: 2025-Q1 (2025-04-01)
Found 146 R-code trusts out of 159 total
Processing R0A: 385 records
Processing R0D: 370 records
Processing R1F: 307 records
Processing R1H: 373 records
Processing RA2: 359 records
Processing RA9: 338 records
Processing RAE: 346 records
Processing RAJ: 375 records
Processing RAL: 362 records
Processing RAS: 268 records
Processing RAX: 299 records
Processing RBD: 315 records
Processing RBK: 251 records
Processing RBN: 344 records
Processing RBT: 266 records
Processing RC9: 350 records
Processing RCB: 342 records
Processing RCD: 318 records
Processing RCF: 274 records
Processing RCX: 293 records
Processing RD1: 366 records
Processing RD8: 339 records
Processing RDE: 367 records
Processing RDU: 362 records
Processing REF: 380 records
Processing REM: 323 records
Processing RF4: 366 records
Processing RFF: 301 records
Processing RFR: 297 records
Processing RFS: 314 records
Processing RGN: 348 records
Processing RGP: 327 records
Processing RGR: 307 records
Processing RGT: 371 records
Processing RH5: 373 records
Processing RH8: 372 records
Processing RHM: 378 records
Processing RHQ: 384 records
Processing RHU: 369 records
Processing RHW: 356 records
Processing RJ1: 373 records
Processing RJ2: 314 records
Processing RJ6: 270 records
Processing RJ7: 355 records
Processing RJC: 314 records
Processing RJE: 379 records
Processing RJL: 274 records
Processing RJN: 229 records
Processing RJZ: 353 records
Processing RK5: 290 records
Processing RK9: 380 records
Processing RKB: 379 records
Processing RKE: 239 records
Processing RL4: 374 records
Processing RLQ: 275 records
Processing RLT: 245 records
Processing RM1: 343 records
Processing RMC: 297 records
Processing RMP: 260 records
Processing RN5: 363 records
Processing RN7: 284 records
Processing RNA: 338 records
Processing RNN: 282 records
Processing RNQ: 312 records
Processing RNS: 349 records
Processing RNZ: 306 records
Processing RP5: 327 records
Processing RPA: 298 records
Processing RPY: 325 records
Processing RQM: 332 records
Processing RQW: 296 records
Processing RQX: 283 records
Processing RR7: 293 records
Processing RR8: 368 records
Processing RRF: 305 records
Processing RRK: 378 records
Processing RRV: 376 records
Processing RTD: 385 records
Processing RTE: 361 records
Processing RTF: 306 records
Processing RTG: 376 records
Processing RTH: 376 records
Processing RTK: 302 records
Processing RTP: 342 records
Processing RTR: 351 records
Processing RTX: 341 records
Processing RVJ: 322 records
Processing RVV: 369 records
Processing RVW: 321 records
Processing RWA: 366 records
Processing RWD: 364 records
Processing RWF: 352 records
Processing RWG: 312 records
Processing RWH: 355 records
Processing RWP: 342 records
Processing RWW: 257 records
Processing RWY: 348 records
Processing RX1: 375 records
Processing RXC: 327 records
Processing RXF: 345 records
Processing RXK: 292 records
Processing RXL: 317 records
Processing RXN: 359 records
Processing RXP: 326 records
Processing RXQ: 324 records
Processing RXR: 357 records
Processing RXW: 367 records
Processing RYR: 384 records
Processing RYJ: 357 records
Processing RBL: 320 records
Processing RJR: 290 records
Processing RN3: 326 records
Processing RWE: 363 records
Processing R1K: 325 records
Processing RA7: 346 records
Processing REP: 63 records
Processing RM3: 353 records
Processing RQ3: 76 records
Processing RWJ: 247 records
Processing R0B: 314 records
Processing RBQ: 97 records
Processing RVR: 255 records
Processing RET: 40 records
Processing RAN: 70 records
Processing RPC: 122 records
Processing RCU: 37 records
Processing RRJ: 61 records
Processing RY2: 34 records
Processing RBV: 310 records
Processing REN: 280 records
Processing RL1: 42 records
Processing RP6: 31 records
Processing R1A: 4 records
Processing RGM: 66 records
Processing RP4: 37 records
Processing RX8: 4 records
Processing RW5: 2 records
Processing RX2: 2 records
Processing RBS: 23 records
Processing RV3: 2 records
Processing RWV: 2 records
Processing RV9: 2 records
Processing R1L: 2 records
Processing RX4: 2 records
Processing RYA: 4 records
Processing RYX: 2 records
Successfully processed 146 trusts
    ✅ Success: 146 trusts processed in 4.82s

🔀 Test 2: Data Transformation Accuracy
  🔀 Testing transformation with CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx
    📊 Raw data: 61780 rows, 11 columns

Processing file: CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61780 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP']
Determined period: 2024-Q1 (2024-04-01)
Found 147 R-code trusts out of 166 total
Processing R0A: 567 records
Processing R0D: 562 records
Processing R1F: 465 records
Processing R1H: 540 records
Processing R1K: 488 records
Processing RA2: 542 records
Processing RA9: 490 records
Processing RAE: 521 records
Processing RAJ: 559 records
Processing RAS: 416 records
Processing RAX: 445 records
Processing RBD: 471 records
Processing RBK: 374 records
Processing RBN: 505 records
Processing RBT: 461 records
Processing RC9: 532 records
Processing RCB: 512 records
Processing RCD: 476 records
Processing RCF: 425 records
Processing RCX: 452 records
Processing RD1: 537 records
Processing RD8: 522 records
Processing RDE: 560 records
Processing RDU: 551 records
Processing REF: 570 records
Processing REM: 475 records
Processing RF4: 523 records
Processing RFF: 434 records
Processing RFR: 444 records
Processing RFS: 470 records
Processing RGN: 510 records
Processing RGP: 463 records
Processing RGR: 462 records
Processing RGT: 553 records
Processing RH5: 549 records
Processing RH8: 552 records
Processing RHM: 566 records
Processing RHQ: 566 records
Processing RHU: 555 records
Processing RHW: 543 records
Processing RJ1: 562 records
Processing RJ2: 471 records
Processing RJ6: 440 records
Processing RJ7: 523 records
Processing RJC: 460 records
Processing RJE: 572 records
Processing RJL: 421 records
Processing RJN: 344 records
Processing RJZ: 531 records
Processing RK5: 413 records
Processing RK9: 579 records
Processing RKB: 553 records
Processing RKE: 386 records
Processing RL4: 549 records
Processing RLQ: 381 records
Processing RLT: 376 records
Processing RM1: 514 records
Processing RMC: 445 records
Processing RMP: 392 records
Processing RN3: 508 records
Processing RN5: 528 records
Processing RN7: 407 records
Processing RNA: 511 records
Processing RNN: 421 records
Processing RNQ: 463 records
Processing RNS: 536 records
Processing RNZ: 492 records
Processing RP5: 473 records
Processing RPA: 447 records
Processing RPY: 479 records
Processing RQM: 475 records
Processing RQW: 444 records
Processing RQX: 406 records
Processing RR7: 432 records
Processing RR8: 568 records
Processing RRF: 466 records
Processing RRK: 557 records
Processing RRV: 553 records
Processing RTD: 587 records
Processing RTE: 540 records
Processing RTF: 450 records
Processing RTG: 557 records
Processing RTH: 564 records
Processing RTK: 432 records
Processing RTP: 489 records
Processing RTR: 526 records
Processing RTX: 513 records
Processing RVJ: 463 records
Processing RVV: 558 records
Processing RVW: 454 records
Processing RWA: 523 records
Processing RWD: 540 records
Processing RWE: 542 records
Processing RWF: 534 records
Processing RWG: 485 records
Processing RWH: 528 records
Processing RWP: 523 records
Processing RWY: 510 records
Processing RX1: 562 records
Processing RXC: 484 records
Processing RXF: 515 records
Processing RXK: 433 records
Processing RXL: 463 records
Processing RXN: 538 records
Processing RXP: 441 records
Processing RXQ: 482 records
Processing RXR: 549 records
Processing RXW: 535 records
Processing RYJ: 563 records
Processing RYR: 580 records
Processing RWW: 402 records
Processing RAL: 522 records
Processing RBL: 461 records
Processing RJR: 450 records
Processing RA7: 509 records
Processing RAP: 460 records
Processing REP: 104 records
Processing RM3: 501 records
Processing RQ3: 121 records
Processing RVR: 350 records
Processing RWJ: 381 records
Processing R0B: 466 records
Processing RBQ: 135 records
Processing RET: 63 records
Processing RP6: 72 records
Processing RAN: 125 records
Processing RBS: 64 records
Processing RCU: 44 records
Processing RPC: 159 records
Processing RRJ: 88 records
Processing RY2: 58 records
Processing RBV: 451 records
Processing REN: 412 records
Processing RPG: 2 records
Processing RX2: 13 records
Processing RL1: 67 records
Processing RXY: 1 records
Processing RGM: 90 records
Processing RP4: 51 records
Processing R1L: 4 records
Processing RYX: 2 records
Processing RX3: 2 records
Processing RT1: 4 records
Processing RV9: 4 records
Processing RQY: 2 records
Processing RWK: 4 records
Processing RXV: 2 records
Successfully processed 147 trusts
    🎯 Transformation accuracy: 100.0%
    📝 Sample validations: 3

🧮 Test 3: Performance Calculation Verification

Processing file: CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61780 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP']
Determined period: 2024-Q1 (2024-04-01)
Found 147 R-code trusts out of 166 total
Processing R0A: 567 records
Processing R0D: 562 records
Processing R1F: 465 records
Processing R1H: 540 records
Processing R1K: 488 records
Processing RA2: 542 records
Processing RA9: 490 records
Processing RAE: 521 records
Processing RAJ: 559 records
Processing RAS: 416 records
Processing RAX: 445 records
Processing RBD: 471 records
Processing RBK: 374 records
Processing RBN: 505 records
Processing RBT: 461 records
Processing RC9: 532 records
Processing RCB: 512 records
Processing RCD: 476 records
Processing RCF: 425 records
Processing RCX: 452 records
Processing RD1: 537 records
Processing RD8: 522 records
Processing RDE: 560 records
Processing RDU: 551 records
Processing REF: 570 records
Processing REM: 475 records
Processing RF4: 523 records
Processing RFF: 434 records
Processing RFR: 444 records
Processing RFS: 470 records
Processing RGN: 510 records
Processing RGP: 463 records
Processing RGR: 462 records
Processing RGT: 553 records
Processing RH5: 549 records
Processing RH8: 552 records
Processing RHM: 566 records
Processing RHQ: 566 records
Processing RHU: 555 records
Processing RHW: 543 records
Processing RJ1: 562 records
Processing RJ2: 471 records
Processing RJ6: 440 records
Processing RJ7: 523 records
Processing RJC: 460 records
Processing RJE: 572 records
Processing RJL: 421 records
Processing RJN: 344 records
Processing RJZ: 531 records
Processing RK5: 413 records
Processing RK9: 579 records
Processing RKB: 553 records
Processing RKE: 386 records
Processing RL4: 549 records
Processing RLQ: 381 records
Processing RLT: 376 records
Processing RM1: 514 records
Processing RMC: 445 records
Processing RMP: 392 records
Processing RN3: 508 records
Processing RN5: 528 records
Processing RN7: 407 records
Processing RNA: 511 records
Processing RNN: 421 records
Processing RNQ: 463 records
Processing RNS: 536 records
Processing RNZ: 492 records
Processing RP5: 473 records
Processing RPA: 447 records
Processing RPY: 479 records
Processing RQM: 475 records
Processing RQW: 444 records
Processing RQX: 406 records
Processing RR7: 432 records
Processing RR8: 568 records
Processing RRF: 466 records
Processing RRK: 557 records
Processing RRV: 553 records
Processing RTD: 587 records
Processing RTE: 540 records
Processing RTF: 450 records
Processing RTG: 557 records
Processing RTH: 564 records
Processing RTK: 432 records
Processing RTP: 489 records
Processing RTR: 526 records
Processing RTX: 513 records
Processing RVJ: 463 records
Processing RVV: 558 records
Processing RVW: 454 records
Processing RWA: 523 records
Processing RWD: 540 records
Processing RWE: 542 records
Processing RWF: 534 records
Processing RWG: 485 records
Processing RWH: 528 records
Processing RWP: 523 records
Processing RWY: 510 records
Processing RX1: 562 records
Processing RXC: 484 records
Processing RXF: 515 records
Processing RXK: 433 records
Processing RXL: 463 records
Processing RXN: 538 records
Processing RXP: 441 records
Processing RXQ: 482 records
Processing RXR: 549 records
Processing RXW: 535 records
Processing RYJ: 563 records
Processing RYR: 580 records
Processing RWW: 402 records
Processing RAL: 522 records
Processing RBL: 461 records
Processing RJR: 450 records
Processing RA7: 509 records
Processing RAP: 460 records
Processing REP: 104 records
Processing RM3: 501 records
Processing RQ3: 121 records
Processing RVR: 350 records
Processing RWJ: 381 records
Processing R0B: 466 records
Processing RBQ: 135 records
Processing RET: 63 records
Processing RP6: 72 records
Processing RAN: 125 records
Processing RBS: 64 records
Processing RCU: 44 records
Processing RPC: 159 records
Processing RRJ: 88 records
Processing RY2: 58 records
Processing RBV: 451 records
Processing REN: 412 records
Processing RPG: 2 records
Processing RX2: 13 records
Processing RL1: 67 records
Processing RXY: 1 records
Processing RGM: 90 records
Processing RP4: 51 records
Processing R1L: 4 records
Processing RYX: 2 records
Processing RX3: 2 records
Processing RT1: 4 records
Processing RV9: 4 records
Processing RQY: 2 records
Processing RWK: 4 records
Processing RXV: 2 records
Successfully processed 147 trusts

Processing file: CWT-CRS-Oct-2024-to-Mar-2025-Data-Extract-Provider.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61649 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['OCT', 'NOV', 'DEC', 'JAN', 'FEB', 'MAR']
Determined period: 2025-Q3 (2025-10-01)
Found 144 R-code trusts out of 158 total
Processing R0A: 572 records
Processing R0D: 560 records
Processing R1F: 445 records
Processing R1H: 557 records
Processing RA2: 543 records
Processing RA9: 505 records
Processing RAE: 522 records
Processing RAJ: 563 records
Processing RAP: 226 records
Processing RAS: 400 records
Processing RAX: 436 records
Processing RBD: 439 records
Processing RBK: 382 records
Processing RBN: 501 records
Processing RBT: 450 records
Processing RC9: 534 records
Processing RCB: 510 records
Processing RCD: 479 records
Processing RCF: 432 records
Processing RCX: 420 records
Processing RD1: 538 records
Processing RD8: 513 records
Processing RDU: 552 records
Processing REF: 569 records
Processing REM: 481 records
Processing RF4: 542 records
Processing RFF: 450 records
Processing RFR: 460 records
Processing RFS: 468 records
Processing RGN: 513 records
Processing RGP: 475 records
Processing RGR: 471 records
Processing RGT: 554 records
Processing RH5: 561 records
Processing RH8: 544 records
Processing RHM: 572 records
Processing RHQ: 578 records
Processing RHU: 561 records
Processing RHW: 551 records
Processing RJ1: 551 records
Processing RJ2: 462 records
Processing RJ6: 427 records
Processing RJ7: 533 records
Processing RJC: 467 records
Processing RJE: 570 records
Processing RJL: 418 records
Processing RJN: 339 records
Processing RJZ: 530 records
Processing RK5: 429 records
Processing RK9: 573 records
Processing RKB: 558 records
Processing RKE: 378 records
Processing RL4: 544 records
Processing RLQ: 409 records
Processing RLT: 383 records
Processing RM1: 510 records
Processing RMC: 450 records
Processing RMP: 391 records
Processing RN5: 531 records
Processing RN7: 410 records
Processing RNA: 501 records
Processing RNN: 421 records
Processing RNQ: 479 records
Processing RNS: 526 records
Processing RNZ: 469 records
Processing RP5: 470 records
Processing RPA: 447 records
Processing RPY: 475 records
Processing RQM: 494 records
Processing RQW: 439 records
Processing RQX: 395 records
Processing RR7: 441 records
Processing RR8: 566 records
Processing RRF: 459 records
Processing RRK: 565 records
Processing RRV: 550 records
Processing RTD: 592 records
Processing RTE: 550 records
Processing RTF: 463 records
Processing RTG: 561 records
Processing RTH: 574 records
Processing RTK: 432 records
Processing RTP: 496 records
Processing RTR: 536 records
Processing RTX: 507 records
Processing RVJ: 485 records
Processing RVV: 560 records
Processing RVW: 464 records
Processing RWA: 529 records
Processing RWD: 542 records
Processing RWF: 541 records
Processing RWG: 475 records
Processing RWH: 523 records
Processing RWP: 515 records
Processing RWW: 404 records
Processing RWY: 530 records
Processing RX1: 566 records
Processing RXC: 494 records
Processing RXF: 528 records
Processing RXK: 446 records
Processing RXL: 452 records
Processing RXN: 535 records
Processing RXP: 453 records
Processing RXQ: 485 records
Processing RXR: 533 records
Processing RXW: 544 records
Processing RYJ: 553 records
Processing RYR: 582 records
Processing R1K: 482 records
Processing RAL: 532 records
Processing RBL: 472 records
Processing REP: 98 records
Processing RN3: 497 records
Processing RDE: 554 records
Processing RJR: 451 records
Processing RWE: 546 records
Processing RA7: 523 records
Processing RM3: 517 records
Processing RQ3: 107 records
Processing RWJ: 375 records
Processing R0B: 472 records
Processing RBQ: 130 records
Processing RVR: 366 records
Processing RET: 65 records
Processing RAN: 114 records
Processing RBS: 44 records
Processing RCU: 46 records
Processing RPC: 158 records
Processing RRJ: 85 records
Processing RY2: 64 records
Processing RBV: 456 records
Processing REN: 411 records
Processing RL1: 79 records
Processing RP6: 72 records
Processing RGM: 97 records
Processing RP4: 58 records
Processing RXV: 2 records
Processing R1D: 4 records
Processing RYX: 2 records
Processing R1A: 4 records
Processing RX2: 4 records
Processing RDR: 1 records
Processing RWK: 2 records
Processing RMY: 2 records
Successfully processed 144 trusts

Processing file: CWT-CRS-Apr-2025-to-Jul-2025-Data-Extract-Provider.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 41013 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['APR', 'MAY', 'JUN', 'JUL']
Determined period: 2025-Q1 (2025-04-01)
Found 146 R-code trusts out of 159 total
Processing R0A: 385 records
Processing R0D: 370 records
Processing R1F: 307 records
Processing R1H: 373 records
Processing RA2: 359 records
Processing RA9: 338 records
Processing RAE: 346 records
Processing RAJ: 375 records
Processing RAL: 362 records
Processing RAS: 268 records
Processing RAX: 299 records
Processing RBD: 315 records
Processing RBK: 251 records
Processing RBN: 344 records
Processing RBT: 266 records
Processing RC9: 350 records
Processing RCB: 342 records
Processing RCD: 318 records
Processing RCF: 274 records
Processing RCX: 293 records
Processing RD1: 366 records
Processing RD8: 339 records
Processing RDE: 367 records
Processing RDU: 362 records
Processing REF: 380 records
Processing REM: 323 records
Processing RF4: 366 records
Processing RFF: 301 records
Processing RFR: 297 records
Processing RFS: 314 records
Processing RGN: 348 records
Processing RGP: 327 records
Processing RGR: 307 records
Processing RGT: 371 records
Processing RH5: 373 records
Processing RH8: 372 records
Processing RHM: 378 records
Processing RHQ: 384 records
Processing RHU: 369 records
Processing RHW: 356 records
Processing RJ1: 373 records
Processing RJ2: 314 records
Processing RJ6: 270 records
Processing RJ7: 355 records
Processing RJC: 314 records
Processing RJE: 379 records
Processing RJL: 274 records
Processing RJN: 229 records
Processing RJZ: 353 records
Processing RK5: 290 records
Processing RK9: 380 records
Processing RKB: 379 records
Processing RKE: 239 records
Processing RL4: 374 records
Processing RLQ: 275 records
Processing RLT: 245 records
Processing RM1: 343 records
Processing RMC: 297 records
Processing RMP: 260 records
Processing RN5: 363 records
Processing RN7: 284 records
Processing RNA: 338 records
Processing RNN: 282 records
Processing RNQ: 312 records
Processing RNS: 349 records
Processing RNZ: 306 records
Processing RP5: 327 records
Processing RPA: 298 records
Processing RPY: 325 records
Processing RQM: 332 records
Processing RQW: 296 records
Processing RQX: 283 records
Processing RR7: 293 records
Processing RR8: 368 records
Processing RRF: 305 records
Processing RRK: 378 records
Processing RRV: 376 records
Processing RTD: 385 records
Processing RTE: 361 records
Processing RTF: 306 records
Processing RTG: 376 records
Processing RTH: 376 records
Processing RTK: 302 records
Processing RTP: 342 records
Processing RTR: 351 records
Processing RTX: 341 records
Processing RVJ: 322 records
Processing RVV: 369 records
Processing RVW: 321 records
Processing RWA: 366 records
Processing RWD: 364 records
Processing RWF: 352 records
Processing RWG: 312 records
Processing RWH: 355 records
Processing RWP: 342 records
Processing RWW: 257 records
Processing RWY: 348 records
Processing RX1: 375 records
Processing RXC: 327 records
Processing RXF: 345 records
Processing RXK: 292 records
Processing RXL: 317 records
Processing RXN: 359 records
Processing RXP: 326 records
Processing RXQ: 324 records
Processing RXR: 357 records
Processing RXW: 367 records
Processing RYR: 384 records
Processing RYJ: 357 records
Processing RBL: 320 records
Processing RJR: 290 records
Processing RN3: 326 records
Processing RWE: 363 records
Processing R1K: 325 records
Processing RA7: 346 records
Processing REP: 63 records
Processing RM3: 353 records
Processing RQ3: 76 records
Processing RWJ: 247 records
Processing R0B: 314 records
Processing RBQ: 97 records
Processing RVR: 255 records
Processing RET: 40 records
Processing RAN: 70 records
Processing RPC: 122 records
Processing RCU: 37 records
Processing RRJ: 61 records
Processing RY2: 34 records
Processing RBV: 310 records
Processing REN: 280 records
Processing RL1: 42 records
Processing RP6: 31 records
Processing R1A: 4 records
Processing RGM: 66 records
Processing RP4: 37 records
Processing RX8: 4 records
Processing RW5: 2 records
Processing RX2: 2 records
Processing RBS: 23 records
Processing RV3: 2 records
Processing RWV: 2 records
Processing RV9: 2 records
Processing R1L: 2 records
Processing RX4: 2 records
Processing RYA: 4 records
Processing RYX: 2 records
Successfully processed 146 trusts
  🧮 Calculations tested: 45
  ✅ Accurate calculations: 45 (100.0%)
  ❌ Calculation errors: 0

🗺️ Test 4: Mapping and Categorization Accuracy
  🗺️ Cancer Type Mappings: 93.8% (30/32)
  🗺️ Route Mappings: 100.0% (9/9)
  🗺️ Modality Mappings: 100.0% (5/5)
  ⚠️ Unmapped cancer types: 2
    - 'Urological - Other (a)'
    - 'Urological - Prostate'

🏗️ Test 5: JSONB Structure Validation

Processing file: CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61780 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP']
Determined period: 2024-Q1 (2024-04-01)
Found 147 R-code trusts out of 166 total
Processing R0A: 567 records
Processing R0D: 562 records
Processing R1F: 465 records
Processing R1H: 540 records
Processing R1K: 488 records
Processing RA2: 542 records
Processing RA9: 490 records
Processing RAE: 521 records
Processing RAJ: 559 records
Processing RAS: 416 records
Processing RAX: 445 records
Processing RBD: 471 records
Processing RBK: 374 records
Processing RBN: 505 records
Processing RBT: 461 records
Processing RC9: 532 records
Processing RCB: 512 records
Processing RCD: 476 records
Processing RCF: 425 records
Processing RCX: 452 records
Processing RD1: 537 records
Processing RD8: 522 records
Processing RDE: 560 records
Processing RDU: 551 records
Processing REF: 570 records
Processing REM: 475 records
Processing RF4: 523 records
Processing RFF: 434 records
Processing RFR: 444 records
Processing RFS: 470 records
Processing RGN: 510 records
Processing RGP: 463 records
Processing RGR: 462 records
Processing RGT: 553 records
Processing RH5: 549 records
Processing RH8: 552 records
Processing RHM: 566 records
Processing RHQ: 566 records
Processing RHU: 555 records
Processing RHW: 543 records
Processing RJ1: 562 records
Processing RJ2: 471 records
Processing RJ6: 440 records
Processing RJ7: 523 records
Processing RJC: 460 records
Processing RJE: 572 records
Processing RJL: 421 records
Processing RJN: 344 records
Processing RJZ: 531 records
Processing RK5: 413 records
Processing RK9: 579 records
Processing RKB: 553 records
Processing RKE: 386 records
Processing RL4: 549 records
Processing RLQ: 381 records
Processing RLT: 376 records
Processing RM1: 514 records
Processing RMC: 445 records
Processing RMP: 392 records
Processing RN3: 508 records
Processing RN5: 528 records
Processing RN7: 407 records
Processing RNA: 511 records
Processing RNN: 421 records
Processing RNQ: 463 records
Processing RNS: 536 records
Processing RNZ: 492 records
Processing RP5: 473 records
Processing RPA: 447 records
Processing RPY: 479 records
Processing RQM: 475 records
Processing RQW: 444 records
Processing RQX: 406 records
Processing RR7: 432 records
Processing RR8: 568 records
Processing RRF: 466 records
Processing RRK: 557 records
Processing RRV: 553 records
Processing RTD: 587 records
Processing RTE: 540 records
Processing RTF: 450 records
Processing RTG: 557 records
Processing RTH: 564 records
Processing RTK: 432 records
Processing RTP: 489 records
Processing RTR: 526 records
Processing RTX: 513 records
Processing RVJ: 463 records
Processing RVV: 558 records
Processing RVW: 454 records
Processing RWA: 523 records
Processing RWD: 540 records
Processing RWE: 542 records
Processing RWF: 534 records
Processing RWG: 485 records
Processing RWH: 528 records
Processing RWP: 523 records
Processing RWY: 510 records
Processing RX1: 562 records
Processing RXC: 484 records
Processing RXF: 515 records
Processing RXK: 433 records
Processing RXL: 463 records
Processing RXN: 538 records
Processing RXP: 441 records
Processing RXQ: 482 records
Processing RXR: 549 records
Processing RXW: 535 records
Processing RYJ: 563 records
Processing RYR: 580 records
Processing RWW: 402 records
Processing RAL: 522 records
Processing RBL: 461 records
Processing RJR: 450 records
Processing RA7: 509 records
Processing RAP: 460 records
Processing REP: 104 records
Processing RM3: 501 records
Processing RQ3: 121 records
Processing RVR: 350 records
Processing RWJ: 381 records
Processing R0B: 466 records
Processing RBQ: 135 records
Processing RET: 63 records
Processing RP6: 72 records
Processing RAN: 125 records
Processing RBS: 64 records
Processing RCU: 44 records
Processing RPC: 159 records
Processing RRJ: 88 records
Processing RY2: 58 records
Processing RBV: 451 records
Processing REN: 412 records
Processing RPG: 2 records
Processing RX2: 13 records
Processing RL1: 67 records
Processing RXY: 1 records
Processing RGM: 90 records
Processing RP4: 51 records
Processing R1L: 4 records
Processing RYX: 2 records
Processing RX3: 2 records
Processing RT1: 4 records
Processing RV9: 4 records
Processing RQY: 2 records
Processing RWK: 4 records
Processing RXV: 2 records
Successfully processed 147 trusts

Processing file: CWT-CRS-Oct-2024-to-Mar-2025-Data-Extract-Provider.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61649 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['OCT', 'NOV', 'DEC', 'JAN', 'FEB', 'MAR']
Determined period: 2025-Q3 (2025-10-01)
Found 144 R-code trusts out of 158 total
Processing R0A: 572 records
Processing R0D: 560 records
Processing R1F: 445 records
Processing R1H: 557 records
Processing RA2: 543 records
Processing RA9: 505 records
Processing RAE: 522 records
Processing RAJ: 563 records
Processing RAP: 226 records
Processing RAS: 400 records
Processing RAX: 436 records
Processing RBD: 439 records
Processing RBK: 382 records
Processing RBN: 501 records
Processing RBT: 450 records
Processing RC9: 534 records
Processing RCB: 510 records
Processing RCD: 479 records
Processing RCF: 432 records
Processing RCX: 420 records
Processing RD1: 538 records
Processing RD8: 513 records
Processing RDU: 552 records
Processing REF: 569 records
Processing REM: 481 records
Processing RF4: 542 records
Processing RFF: 450 records
Processing RFR: 460 records
Processing RFS: 468 records
Processing RGN: 513 records
Processing RGP: 475 records
Processing RGR: 471 records
Processing RGT: 554 records
Processing RH5: 561 records
Processing RH8: 544 records
Processing RHM: 572 records
Processing RHQ: 578 records
Processing RHU: 561 records
Processing RHW: 551 records
Processing RJ1: 551 records
Processing RJ2: 462 records
Processing RJ6: 427 records
Processing RJ7: 533 records
Processing RJC: 467 records
Processing RJE: 570 records
Processing RJL: 418 records
Processing RJN: 339 records
Processing RJZ: 530 records
Processing RK5: 429 records
Processing RK9: 573 records
Processing RKB: 558 records
Processing RKE: 378 records
Processing RL4: 544 records
Processing RLQ: 409 records
Processing RLT: 383 records
Processing RM1: 510 records
Processing RMC: 450 records
Processing RMP: 391 records
Processing RN5: 531 records
Processing RN7: 410 records
Processing RNA: 501 records
Processing RNN: 421 records
Processing RNQ: 479 records
Processing RNS: 526 records
Processing RNZ: 469 records
Processing RP5: 470 records
Processing RPA: 447 records
Processing RPY: 475 records
Processing RQM: 494 records
Processing RQW: 439 records
Processing RQX: 395 records
Processing RR7: 441 records
Processing RR8: 566 records
Processing RRF: 459 records
Processing RRK: 565 records
Processing RRV: 550 records
Processing RTD: 592 records
Processing RTE: 550 records
Processing RTF: 463 records
Processing RTG: 561 records
Processing RTH: 574 records
Processing RTK: 432 records
Processing RTP: 496 records
Processing RTR: 536 records
Processing RTX: 507 records
Processing RVJ: 485 records
Processing RVV: 560 records
Processing RVW: 464 records
Processing RWA: 529 records
Processing RWD: 542 records
Processing RWF: 541 records
Processing RWG: 475 records
Processing RWH: 523 records
Processing RWP: 515 records
Processing RWW: 404 records
Processing RWY: 530 records
Processing RX1: 566 records
Processing RXC: 494 records
Processing RXF: 528 records
Processing RXK: 446 records
Processing RXL: 452 records
Processing RXN: 535 records
Processing RXP: 453 records
Processing RXQ: 485 records
Processing RXR: 533 records
Processing RXW: 544 records
Processing RYJ: 553 records
Processing RYR: 582 records
Processing R1K: 482 records
Processing RAL: 532 records
Processing RBL: 472 records
Processing REP: 98 records
Processing RN3: 497 records
Processing RDE: 554 records
Processing RJR: 451 records
Processing RWE: 546 records
Processing RA7: 523 records
Processing RM3: 517 records
Processing RQ3: 107 records
Processing RWJ: 375 records
Processing R0B: 472 records
Processing RBQ: 130 records
Processing RVR: 366 records
Processing RET: 65 records
Processing RAN: 114 records
Processing RBS: 44 records
Processing RCU: 46 records
Processing RPC: 158 records
Processing RRJ: 85 records
Processing RY2: 64 records
Processing RBV: 456 records
Processing REN: 411 records
Processing RL1: 79 records
Processing RP6: 72 records
Processing RGM: 97 records
Processing RP4: 58 records
Processing RXV: 2 records
Processing R1D: 4 records
Processing RYX: 2 records
Processing R1A: 4 records
Processing RX2: 4 records
Processing RDR: 1 records
Processing RWK: 2 records
Processing RMY: 2 records
Successfully processed 144 trusts

Processing file: CWT-CRS-Apr-2025-to-Jul-2025-Data-Extract-Provider.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 41013 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['APR', 'MAY', 'JUN', 'JUL']
Determined period: 2025-Q1 (2025-04-01)
Found 146 R-code trusts out of 159 total
Processing R0A: 385 records
Processing R0D: 370 records
Processing R1F: 307 records
Processing R1H: 373 records
Processing RA2: 359 records
Processing RA9: 338 records
Processing RAE: 346 records
Processing RAJ: 375 records
Processing RAL: 362 records
Processing RAS: 268 records
Processing RAX: 299 records
Processing RBD: 315 records
Processing RBK: 251 records
Processing RBN: 344 records
Processing RBT: 266 records
Processing RC9: 350 records
Processing RCB: 342 records
Processing RCD: 318 records
Processing RCF: 274 records
Processing RCX: 293 records
Processing RD1: 366 records
Processing RD8: 339 records
Processing RDE: 367 records
Processing RDU: 362 records
Processing REF: 380 records
Processing REM: 323 records
Processing RF4: 366 records
Processing RFF: 301 records
Processing RFR: 297 records
Processing RFS: 314 records
Processing RGN: 348 records
Processing RGP: 327 records
Processing RGR: 307 records
Processing RGT: 371 records
Processing RH5: 373 records
Processing RH8: 372 records
Processing RHM: 378 records
Processing RHQ: 384 records
Processing RHU: 369 records
Processing RHW: 356 records
Processing RJ1: 373 records
Processing RJ2: 314 records
Processing RJ6: 270 records
Processing RJ7: 355 records
Processing RJC: 314 records
Processing RJE: 379 records
Processing RJL: 274 records
Processing RJN: 229 records
Processing RJZ: 353 records
Processing RK5: 290 records
Processing RK9: 380 records
Processing RKB: 379 records
Processing RKE: 239 records
Processing RL4: 374 records
Processing RLQ: 275 records
Processing RLT: 245 records
Processing RM1: 343 records
Processing RMC: 297 records
Processing RMP: 260 records
Processing RN5: 363 records
Processing RN7: 284 records
Processing RNA: 338 records
Processing RNN: 282 records
Processing RNQ: 312 records
Processing RNS: 349 records
Processing RNZ: 306 records
Processing RP5: 327 records
Processing RPA: 298 records
Processing RPY: 325 records
Processing RQM: 332 records
Processing RQW: 296 records
Processing RQX: 283 records
Processing RR7: 293 records
Processing RR8: 368 records
Processing RRF: 305 records
Processing RRK: 378 records
Processing RRV: 376 records
Processing RTD: 385 records
Processing RTE: 361 records
Processing RTF: 306 records
Processing RTG: 376 records
Processing RTH: 376 records
Processing RTK: 302 records
Processing RTP: 342 records
Processing RTR: 351 records
Processing RTX: 341 records
Processing RVJ: 322 records
Processing RVV: 369 records
Processing RVW: 321 records
Processing RWA: 366 records
Processing RWD: 364 records
Processing RWF: 352 records
Processing RWG: 312 records
Processing RWH: 355 records
Processing RWP: 342 records
Processing RWW: 257 records
Processing RWY: 348 records
Processing RX1: 375 records
Processing RXC: 327 records
Processing RXF: 345 records
Processing RXK: 292 records
Processing RXL: 317 records
Processing RXN: 359 records
Processing RXP: 326 records
Processing RXQ: 324 records
Processing RXR: 357 records
Processing RXW: 367 records
Processing RYR: 384 records
Processing RYJ: 357 records
Processing RBL: 320 records
Processing RJR: 290 records
Processing RN3: 326 records
Processing RWE: 363 records
Processing R1K: 325 records
Processing RA7: 346 records
Processing REP: 63 records
Processing RM3: 353 records
Processing RQ3: 76 records
Processing RWJ: 247 records
Processing R0B: 314 records
Processing RBQ: 97 records
Processing RVR: 255 records
Processing RET: 40 records
Processing RAN: 70 records
Processing RPC: 122 records
Processing RCU: 37 records
Processing RRJ: 61 records
Processing RY2: 34 records
Processing RBV: 310 records
Processing REN: 280 records
Processing RL1: 42 records
Processing RP6: 31 records
Processing R1A: 4 records
Processing RGM: 66 records
Processing RP4: 37 records
Processing RX8: 4 records
Processing RW5: 2 records
Processing RX2: 2 records
Processing RBS: 23 records
Processing RV3: 2 records
Processing RWV: 2 records
Processing RV9: 2 records
Processing R1L: 2 records
Processing RX4: 2 records
Processing RYA: 4 records
Processing RYX: 2 records
Successfully processed 146 trusts
  🏗️ Structures tested: 9
  ✅ Valid structures: 9 (100.0%)
  ❌ Structure errors: 0

💾 Test 6: Data Completeness Preservation

Processing file: CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61780 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP']
Determined period: 2024-Q1 (2024-04-01)
Found 147 R-code trusts out of 166 total
Processing R0A: 567 records
Processing R0D: 562 records
Processing R1F: 465 records
Processing R1H: 540 records
Processing R1K: 488 records
Processing RA2: 542 records
Processing RA9: 490 records
Processing RAE: 521 records
Processing RAJ: 559 records
Processing RAS: 416 records
Processing RAX: 445 records
Processing RBD: 471 records
Processing RBK: 374 records
Processing RBN: 505 records
Processing RBT: 461 records
Processing RC9: 532 records
Processing RCB: 512 records
Processing RCD: 476 records
Processing RCF: 425 records
Processing RCX: 452 records
Processing RD1: 537 records
Processing RD8: 522 records
Processing RDE: 560 records
Processing RDU: 551 records
Processing REF: 570 records
Processing REM: 475 records
Processing RF4: 523 records
Processing RFF: 434 records
Processing RFR: 444 records
Processing RFS: 470 records
Processing RGN: 510 records
Processing RGP: 463 records
Processing RGR: 462 records
Processing RGT: 553 records
Processing RH5: 549 records
Processing RH8: 552 records
Processing RHM: 566 records
Processing RHQ: 566 records
Processing RHU: 555 records
Processing RHW: 543 records
Processing RJ1: 562 records
Processing RJ2: 471 records
Processing RJ6: 440 records
Processing RJ7: 523 records
Processing RJC: 460 records
Processing RJE: 572 records
Processing RJL: 421 records
Processing RJN: 344 records
Processing RJZ: 531 records
Processing RK5: 413 records
Processing RK9: 579 records
Processing RKB: 553 records
Processing RKE: 386 records
Processing RL4: 549 records
Processing RLQ: 381 records
Processing RLT: 376 records
Processing RM1: 514 records
Processing RMC: 445 records
Processing RMP: 392 records
Processing RN3: 508 records
Processing RN5: 528 records
Processing RN7: 407 records
Processing RNA: 511 records
Processing RNN: 421 records
Processing RNQ: 463 records
Processing RNS: 536 records
Processing RNZ: 492 records
Processing RP5: 473 records
Processing RPA: 447 records
Processing RPY: 479 records
Processing RQM: 475 records
Processing RQW: 444 records
Processing RQX: 406 records
Processing RR7: 432 records
Processing RR8: 568 records
Processing RRF: 466 records
Processing RRK: 557 records
Processing RRV: 553 records
Processing RTD: 587 records
Processing RTE: 540 records
Processing RTF: 450 records
Processing RTG: 557 records
Processing RTH: 564 records
Processing RTK: 432 records
Processing RTP: 489 records
Processing RTR: 526 records
Processing RTX: 513 records
Processing RVJ: 463 records
Processing RVV: 558 records
Processing RVW: 454 records
Processing RWA: 523 records
Processing RWD: 540 records
Processing RWE: 542 records
Processing RWF: 534 records
Processing RWG: 485 records
Processing RWH: 528 records
Processing RWP: 523 records
Processing RWY: 510 records
Processing RX1: 562 records
Processing RXC: 484 records
Processing RXF: 515 records
Processing RXK: 433 records
Processing RXL: 463 records
Processing RXN: 538 records
Processing RXP: 441 records
Processing RXQ: 482 records
Processing RXR: 549 records
Processing RXW: 535 records
Processing RYJ: 563 records
Processing RYR: 580 records
Processing RWW: 402 records
Processing RAL: 522 records
Processing RBL: 461 records
Processing RJR: 450 records
Processing RA7: 509 records
Processing RAP: 460 records
Processing REP: 104 records
Processing RM3: 501 records
Processing RQ3: 121 records
Processing RVR: 350 records
Processing RWJ: 381 records
Processing R0B: 466 records
Processing RBQ: 135 records
Processing RET: 63 records
Processing RP6: 72 records
Processing RAN: 125 records
Processing RBS: 64 records
Processing RCU: 44 records
Processing RPC: 159 records
Processing RRJ: 88 records
Processing RY2: 58 records
Processing RBV: 451 records
Processing REN: 412 records
Processing RPG: 2 records
Processing RX2: 13 records
Processing RL1: 67 records
Processing RXY: 1 records
Processing RGM: 90 records
Processing RP4: 51 records
Processing R1L: 4 records
Processing RYX: 2 records
Processing RX3: 2 records
Processing RT1: 4 records
Processing RV9: 4 records
Processing RQY: 2 records
Processing RWK: 4 records
Processing RXV: 2 records
Successfully processed 147 trusts
  💾 CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx:
    - Raw records: 61,780
    - Raw trusts: 166
    - Processed trusts: 147
    - Trust preservation: 88.6%

Processing file: CWT-CRS-Oct-2024-to-Mar-2025-Data-Extract-Provider.xlsx
Successfully read sheet: CWT CRS Provider Extract
Loaded 61649 rows, 11 columns
Columns: ['PERIOD', 'YEAR', 'MONTH', 'STANDARD', 'ORG CODE', 'STAGE/ROUTE', 'TREATMENT MODALITY', 'CANCER TYPE', 'TOTAL TREATED', 'WITHIN STANDARD', 'BREACHES']
Months in file: ['OCT', 'NOV', 'DEC', 'JAN', 'FEB', 'MAR']
Determined period: 2025-Q3 (2025-10-01)
Found 144 R-code trusts out of 158 total
Processing R0A: 572 records
Processing R0D: 560 records
Processing R1F: 445 records
Processing R1H: 557 records
Processing RA2: 543 records
Processing RA9: 505 records
Processing RAE: 522 records
Processing RAJ: 563 records
Processing RAP: 226 records
Processing RAS: 400 records
Processing RAX: 436 records
Processing RBD: 439 records
Processing RBK: 382 records
Processing RBN: 501 records
Processing RBT: 450 records
Processing RC9: 534 records
Processing RCB: 510 records
Processing RCD: 479 records
Processing RCF: 432 records
Processing RCX: 420 records
Processing RD1: 538 records
Processing RD8: 513 records
Processing RDU: 552 records
Processing REF: 569 records
Processing REM: 481 records
Processing RF4: 542 records
Processing RFF: 450 records
Processing RFR: 460 records
Processing RFS: 468 records
Processing RGN: 513 records
Processing RGP: 475 records
Processing RGR: 471 records
Processing RGT: 554 records
Processing RH5: 561 records
Processing RH8: 544 records
Processing RHM: 572 records
Processing RHQ: 578 records
Processing RHU: 561 records
Processing RHW: 551 records
Processing RJ1: 551 records
Processing RJ2: 462 records
Processing RJ6: 427 records
Processing RJ7: 533 records
Processing RJC: 467 records
Processing RJE: 570 records
Processing RJL: 418 records
Processing RJN: 339 records
Processing RJZ: 530 records
Processing RK5: 429 records
Processing RK9: 573 records
Processing RKB: 558 records
Processing RKE: 378 records
Processing RL4: 544 records
Processing RLQ: 409 records
Processing RLT: 383 records
Processing RM1: 510 records
Processing RMC: 450 records
Processing RMP: 391 records
Processing RN5: 531 records
Processing RN7: 410 records
Processing RNA: 501 records
Processing RNN: 421 records
Processing RNQ: 479 records
Processing RNS: 526 records
Processing RNZ: 469 records
Processing RP5: 470 records
Processing RPA: 447 records
Processing RPY: 475 records
Processing RQM: 494 records
Processing RQW: 439 records
Processing RQX: 395 records
Processing RR7: 441 records
Processing RR8: 566 records
Processing RRF: 459 records
Processing RRK: 565 records
Processing RRV: 550 records
Processing RTD: 592 records
Processing RTE: 550 records
Processing RTF: 463 records
Processing RTG: 561 records
Processing RTH: 574 records
Processing RTK: 432 records
Processing RTP: 496 records
Processing RTR: 536 records
Processing RTX: 507 records
Processing RVJ: 485 records
Processing RVV: 560 records
Processing RVW: 464 records
Processing RWA: 529 records
Processing RWD: 542 records
Processing RWF: 541 records
Processing RWG: 475 records
Processing RWH: 523 records
Processing RWP: 515 records
Processing RWW: 404 records
Processing RWY: 530 records
Processing RX1: 566 records
Processing RXC: 494 records
Processing RXF: 528 records
Processing RXK: 446 records
Processing RXL: 452 records
Processing RXN: 535 records
Processing RXP: 453 records
Processing RXQ: 485 records
Processing RXR: 533 records
Processing RXW: 544 records
Processing RYJ: 553 records
Processing RYR: 582 records
Processing R1K: 482 records
Processing RAL: 532 records
Processing RBL: 472 records
Processing REP: 98 records
Processing RN3: 497 records
Processing RDE: 554 records
Processing RJR: 451 records
Processing RWE: 546 records
Processing RA7: 523 records
Processing RM3: 517 records
Processing RQ3: 107 records
Processing RWJ: 375 records
Processing R0B: 472 records
Processing RBQ: 130 records
Processing RVR: 366 records
Processing RET: 65 records
Processing RAN: 114 records
Processing RBS: 44 records
Processing RCU: 46 records
Processing RPC: 158 records
Processing RRJ: 85 records
Processing RY2: 64 records
Processing RBV: 456 records
Processing REN: 411 records
Processing RL1: 79 records
Processing RP6: 72 records
Processing RGM: 97 records
Processing RP4: 58 records
Processing RXV: 2 records
Processing R1D: 4 records
Processing RYX: 2 records
Processing R1A: 4 records
Processing RX2: 4 records
Processing RDR: 1 records
Processing RWK: 2 records
Processing RMY: 2 records
Successfully processed 144 trusts
  💾 CWT-CRS-Oct-2024-to-Mar-2025-Data-Extract-Provider.xlsx:
    - Raw records: 61,649
    - Raw trusts: 158
    - Processed trusts: 144
    - Trust preservation: 91.1%

📅 Test 7: Quarter Aggregation Accuracy
  📅 CWT-CRS-Apr-2024-to-Sep-2024-Data-Extract-Provider-Final.xlsx: ['APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP'] → 2024-Q1
  📅 Quarter mappings tested: 4
  ✅ Accurate mappings: 4 (100.0%)

📋 Generating Processing Accuracy Summary...

============================================================
📋 PHASE 2 PROCESSING ACCURACY SUMMARY
============================================================
Files processed: 3/3
Overall accuracy score: 100.0/100

Accuracy breakdown:
  Transformation: 100.0%
  Calculations: 100.0%
  Structure: 100.0%

Issues found:
  🚨 Critical: 0
  ⚠️ High: 0
  ❓ Medium: 1

Overall Status: MEDIUM_ISSUES

📋 Recommendations:
  ✅ Proceed to Phase 3 database validation if accuracy is satisfactory

📄 Report saved: /Users/markknapp/Desktop/Projects/NHS-Data-Analytics-Tool-v6-master/data-integrity-tests/phase2_cancer_processing_accuracy_20250926_081537.json

⚠️ Phase 2 processing accuracy validation completed with issues - review before proceeding
