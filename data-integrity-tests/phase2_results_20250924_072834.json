{
  "test_timestamp": "2025-09-24T07:28:30.822467",
  "test_phase": "Phase 2: Database Migration Integrity",
  "data_directory": "/Users/markknapp/Desktop/Projects/NHS-Data-Analytics-Tool-v6-master/Data",
  "results": {
    "database_completeness": {
      "csv_total_records": 1816,
      "csv_unique_trusts": 151,
      "csv_unique_periods": 12,
      "csv_period_range": "2024-08-01 to 2025-07-01",
      "db_total_records": 1812,
      "db_unique_trusts": 84,
      "db_unique_periods": 7,
      "db_period_range": "2024-08-01 to 2025-02-01",
      "missing_trusts": [
        "RWE",
        "RWY",
        "RX1",
        "RTF",
        "RWD",
        "RWG",
        "RWJ",
        "RYW",
        "RTH",
        "RWX",
        "RYJ",
        "RVV",
        "RWH",
        "RRK",
        "RP4",
        "RPY",
        "RRF",
        "RXQ",
        "RT1",
        "RP5",
        "RVR",
        "RXC",
        "RWA",
        "RXG",
        "RXF",
        "RQX",
        "RTK",
        "RNQ",
        "RRE",
        "RPC",
        "RWW",
        "RR7",
        "RWP",
        "RQM",
        "RVJ",
        "RPG",
        "RVW",
        "RX4",
        "RTG",
        "RWF",
        "RYR",
        "RTE",
        "RRJ",
        "RQ3",
        "RTD",
        "RTR",
        "RTX",
        "RNS",
        "RXN",
        "RW1",
        "RP6",
        "RXW",
        "RTP",
        "RPA",
        "RXK",
        "RXR",
        "RXL",
        "RP7",
        "RR8",
        "RXP",
        "RW4",
        "RW5",
        "RQW",
        "RNZ",
        "RRV",
        "TAD",
        "RYY"
      ],
      "extra_trusts": [],
      "missing_periods": [
        "2025-04-01",
        "2025-06-01",
        "2025-03-01",
        "2025-07-01",
        "2025-05-01"
      ],
      "extra_periods": [],
      "record_count_match": true,
      "trust_count_match": false,
      "period_count_match": false,
      "status": "WARN",
      "issues": [
        "Missing 67 trusts in database: ['RWE', 'RWY', 'RX1', 'RTF', 'RWD']",
        "Missing 5 periods in database: ['2025-04-01', '2025-06-01', '2025-03-01', '2025-07-01', '2025-05-01']"
      ]
    },
    "jsonb_structure": {
      "sample_size": 50,
      "fields_analyzed": [
        "rtt_data",
        "ae_data",
        "diagnostics_data",
        "capacity_data"
      ],
      "structure_analysis": {
        "rtt_data": {
          "total_records": 50,
          "populated_count": 50,
          "empty_count": 0,
          "empty_string_count": 0,
          "null_count": 0,
          "valid_json_count": 50,
          "invalid_json_count": 0,
          "structure_examples": [
            {
              "trust_code": "R0A",
              "keys": [
                "specialties",
                "trust_total"
              ],
              "key_count": 2
            },
            {
              "trust_code": "R0A",
              "keys": [
                "specialties",
                "trust_total"
              ],
              "key_count": 2
            },
            {
              "trust_code": "R0A",
              "keys": [
                "specialties",
                "trust_total"
              ],
              "key_count": 2
            }
          ],
          "populated_percentage": 100.0,
          "empty_string_percentage": 0.0
        },
        "ae_data": {
          "total_records": 50,
          "populated_count": 50,
          "empty_count": 0,
          "empty_string_count": 0,
          "null_count": 0,
          "valid_json_count": 50,
          "invalid_json_count": 0,
          "structure_examples": [
            {
              "trust_code": "R0A",
              "keys": [
                "total_attendances",
                "over_four_hours_total",
                "four_hour_performance_pct",
                "emergency_admissions_total",
                "twelve_hour_wait_admissions"
              ],
              "key_count": 5
            },
            {
              "trust_code": "R0A",
              "keys": [
                "total_attendances",
                "over_four_hours_total",
                "four_hour_performance_pct",
                "emergency_admissions_total",
                "twelve_hour_wait_admissions"
              ],
              "key_count": 5
            },
            {
              "trust_code": "R0A",
              "keys": [
                "total_attendances",
                "over_four_hours_total",
                "four_hour_performance_pct",
                "emergency_admissions_total",
                "twelve_hour_wait_admissions"
              ],
              "key_count": 5
            }
          ],
          "populated_percentage": 100.0,
          "empty_string_percentage": 0.0
        },
        "diagnostics_data": {
          "total_records": 50,
          "populated_count": 50,
          "empty_count": 0,
          "empty_string_count": 0,
          "null_count": 0,
          "valid_json_count": 50,
          "invalid_json_count": 0,
          "structure_examples": [
            {
              "trust_code": "R0A",
              "keys": [
                "ct",
                "mri",
                "dexa",
                "audiology",
                "cystoscopy",
                "ultrasound",
                "colonoscopy",
                "gastroscopy",
                "urodynamics",
                "sigmoidoscopy",
                "sleep_studies",
                "neurophysiology",
                "echocardiography",
                "nuclear_medicine",
                "electrophysiology"
              ],
              "key_count": 15
            },
            {
              "trust_code": "R0A",
              "keys": [
                "ct",
                "mri",
                "dexa",
                "audiology",
                "cystoscopy",
                "ultrasound",
                "colonoscopy",
                "gastroscopy",
                "urodynamics",
                "sigmoidoscopy",
                "sleep_studies",
                "neurophysiology",
                "echocardiography",
                "nuclear_medicine",
                "electrophysiology"
              ],
              "key_count": 15
            },
            {
              "trust_code": "R0A",
              "keys": [
                "ct",
                "mri",
                "dexa",
                "audiology",
                "cystoscopy",
                "ultrasound",
                "colonoscopy",
                "gastroscopy",
                "urodynamics",
                "sigmoidoscopy",
                "sleep_studies",
                "neurophysiology",
                "echocardiography",
                "nuclear_medicine",
                "electrophysiology"
              ],
              "key_count": 15
            }
          ],
          "populated_percentage": 100.0,
          "empty_string_percentage": 0.0
        },
        "capacity_data": {
          "total_records": 50,
          "populated_count": 50,
          "empty_count": 0,
          "empty_string_count": 0,
          "null_count": 0,
          "valid_json_count": 50,
          "invalid_json_count": 0,
          "structure_examples": [
            {
              "trust_code": "R0A",
              "keys": [
                "avg_daily_discharges",
                "virtual_ward_capacity",
                "virtual_ward_occupancy_rate"
              ],
              "key_count": 3
            },
            {
              "trust_code": "R0A",
              "keys": [
                "avg_daily_discharges",
                "virtual_ward_capacity",
                "virtual_ward_occupancy_rate"
              ],
              "key_count": 3
            },
            {
              "trust_code": "R0A",
              "keys": [
                "avg_daily_discharges",
                "virtual_ward_capacity",
                "virtual_ward_occupancy_rate"
              ],
              "key_count": 3
            }
          ],
          "populated_percentage": 100.0,
          "empty_string_percentage": 0.0
        }
      },
      "empty_field_analysis": {},
      "data_type_analysis": {},
      "actual_sample_size": 50,
      "overall_status": "PASS",
      "average_populated_percentage": 100.0
    },
    "transformation_accuracy": {
      "sample_size": 25,
      "samples_tested": [
        {
          "trust_code": "RA9",
          "period": "2025-04-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 9583.0,
              "db_value": 9583,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 72.58,
              "db_value": 72.58,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 63.32,
              "db_value": 63.32,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "69244",
              "db_value": 69244,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "R0B",
          "period": "2025-05-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 18292.0,
              "db_value": 18292,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 71.86,
              "db_value": 71.86,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 75.77,
              "db_value": 75.77,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "115330",
              "db_value": 115330,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RF4",
          "period": "2025-01-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 30468.0,
              "db_value": 30468,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 77.72,
              "db_value": 77.72,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 68.2,
              "db_value": 68.2,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "109248",
              "db_value": 109248,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RDR",
          "period": "2024-09-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 11533.0,
              "db_value": 11533,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 99.59,
              "db_value": 99.59,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 67.81,
              "db_value": 67.81,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "11328",
              "db_value": 11328,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "R1D",
          "period": "2025-04-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 3041.0,
              "db_value": 3041,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 99.84,
              "db_value": 99.84,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 58.18,
              "db_value": 58.18,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "18702",
              "db_value": 18702,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RPY",
          "period": "2024-10-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "ae_4hr_performance_pct": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 94.12,
              "db_value": 94.12,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "3914",
              "db_value": 3914,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RAE",
          "period": "2025-01-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 12759.0,
              "db_value": 12759,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 82.06,
              "db_value": 82.06,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 60.62,
              "db_value": 60.62,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "64508",
              "db_value": 64508,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RYW",
          "period": "2024-11-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "ae_4hr_performance_pct": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 67.8,
              "db_value": 67.8,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "33440",
              "db_value": 33440,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RXR",
          "period": "2025-01-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 22091.0,
              "db_value": 22091,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 73.65,
              "db_value": 73.65,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 56.91,
              "db_value": 56.91,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "126344",
              "db_value": 126344,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RM1",
          "period": "2025-04-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 20322.0,
              "db_value": 20322,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 80.2,
              "db_value": 80.2,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 53.06,
              "db_value": 53.06,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "160486",
              "db_value": 160486,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RNQ",
          "period": "2025-04-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 18207.0,
              "db_value": 18207,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 78.7,
              "db_value": 78.7,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 66.53,
              "db_value": 66.53,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "49698",
              "db_value": 49698,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RPC",
          "period": "2025-02-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 1197.0,
              "db_value": 1197,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 99.5,
              "db_value": 99.5,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 56.72,
              "db_value": 56.72,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "37608",
              "db_value": 37608,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RW1",
          "period": "2024-12-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 2915.0,
              "db_value": 2915,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 98.25,
              "db_value": 98.25,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 93.06,
              "db_value": 93.06,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "8042",
              "db_value": 8042,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RFR",
          "period": "2025-01-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 8708.0,
              "db_value": 8708,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 58.72,
              "db_value": 58.72,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 63.7,
              "db_value": 63.7,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "62452",
              "db_value": 62452,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RM3",
          "period": "2025-05-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 35286.0,
              "db_value": 35286,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 68.13,
              "db_value": 68.13,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 53.98,
              "db_value": 53.98,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "275712",
              "db_value": 275712,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RP6",
          "period": "2025-03-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 5789.0,
              "db_value": 5789,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 98.41,
              "db_value": 98.41,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 83.12,
              "db_value": 83.12,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "66272",
              "db_value": 66272,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RF4",
          "period": "2024-09-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 27410.0,
              "db_value": 27410,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 78.37,
              "db_value": 78.37,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 64.04,
              "db_value": 64.04,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "124036",
              "db_value": 124036,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RK9",
          "period": "2024-08-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 14335.0,
              "db_value": 14335,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 67.74,
              "db_value": 67.74,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 58.99,
              "db_value": 58.99,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "99560",
              "db_value": 99560,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RWA",
          "period": "2024-12-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 14063.0,
              "db_value": 14063,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 54.15,
              "db_value": 54.15,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 56.87,
              "db_value": 56.87,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "159992",
              "db_value": 159992,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RQX",
          "period": "2024-11-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 10909.0,
              "db_value": 10909,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 77.31,
              "db_value": 77.31,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 67.98,
              "db_value": 67.98,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "69362",
              "db_value": 69362,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RJC",
          "period": "2025-07-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "ae_4hr_performance_pct": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 65.56,
              "db_value": 65.56,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "66602",
              "db_value": 66602,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RX1",
          "period": "2025-04-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 14649.0,
              "db_value": 14649,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 54.02,
              "db_value": 54.02,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 57.62,
              "db_value": 57.62,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "166162",
              "db_value": 166162,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RBV",
          "period": "2024-08-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 0.0,
              "db_value": 0,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 97.18,
              "db_value": 97.18,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "4970",
              "db_value": 4970,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RTP",
          "period": "2025-07-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "ae_4hr_performance_pct": {
              "csv_value": NaN,
              "db_value": null,
              "accurate": true,
              "notes": [
                "Both values are null/empty"
              ]
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 56.67,
              "db_value": 56.67,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "104356",
              "db_value": 104356,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        },
        {
          "trust_code": "RXN",
          "period": "2025-03-01",
          "field_comparisons": {
            "ae_attendances_total": {
              "csv_value": 15409.0,
              "db_value": 15409,
              "accurate": true,
              "notes": []
            },
            "ae_4hr_performance_pct": {
              "csv_value": 68.64,
              "db_value": 68.64,
              "accurate": true,
              "notes": []
            },
            "trust_total_percent_within_18_weeks": {
              "csv_value": 55.71,
              "db_value": 55.71,
              "accurate": true,
              "notes": []
            },
            "trust_total_total_incomplete_pathways": {
              "csv_value": "121970",
              "db_value": 121970,
              "accurate": true,
              "notes": []
            }
          },
          "accurate_fields": 4,
          "total_fields": 4,
          "overall_accuracy": 1.0
        }
      ],
      "transformation_accuracy": {},
      "value_comparisons": [],
      "failed_transformations": [],
      "actual_sample_size": 25,
      "overall_accuracy": 100.0,
      "status": "PASS"
    },
    "cross_validation": {
      "trust_name_consistency": {
        "total_trusts_checked": 151,
        "inconsistent_names": 2,
        "inconsistent_details": [
          [
            "RAX",
            {
              "csv_name": "KINGSTON AND RICHMOND NHS FOUNDATION TRUST",
              "db_name": "KINGSTON HOSPITAL NHS FOUNDATION TRUST"
            }
          ],
          [
            "RHU",
            {
              "csv_name": "PORTSMOUTH HOSPITALS UNIVERSITY NHS TRUST",
              "db_name": "PORTSMOUTH HOSPITALS UNIVERSITY NATIONAL HEALTH SERVICE TRUST"
            }
          ]
        ]
      },
      "period_continuity": {
        "csv_periods": 12,
        "db_periods": 7,
        "period_gaps": 0,
        "gap_details": []
      },
      "data_relationships": {
        "checks_performed": 10,
        "relationship_violations": 0,
        "violation_details": []
      },
      "completeness_analysis": {},
      "overall_status": "WARN"
    }
  },
  "summary": {
    "overall_status": "WARN",
    "total_issues": 3,
    "critical_issues": 0,
    "warning_issues": 3,
    "tests_passed": 2,
    "tests_total": 4,
    "pass_rate": 50.0
  },
  "issues_found": [
    "Missing 67 trusts in database: ['RWE', 'RWY', 'RX1', 'RTF', 'RWD']",
    "Missing 5 periods in database: ['2025-04-01', '2025-06-01', '2025-03-01', '2025-07-01', '2025-05-01']",
    "Warning: 2 trusts have inconsistent names between CSV and database"
  ],
  "recommendations": [
    "\ud83d\udfe1 Some migration quality issues detected - recommend review",
    "Consider data quality improvements in transformation process"
  ],
  "sample_validations": []
}