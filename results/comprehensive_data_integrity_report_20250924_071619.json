{
  "report_metadata": {
    "generation_timestamp": "2025-09-24T07:16:19.534996",
    "report_type": "NHS Data Analytics - Comprehensive Data Integrity Assessment",
    "test_phases_included": [
      "phase1",
      "phase2",
      "phase3"
    ],
    "assessment_scope": "Source data verification, database migration integrity, business logic validation"
  },
  "executive_summary": {
    "assessment_date": "2025-09-24",
    "overall_system_status": "CRITICAL",
    "data_confidence_level": "LOW",
    "total_records_assessed": {
      "source_csv": 1816,
      "database": 1766
    },
    "issue_summary": {
      "total_issues": 16,
      "critical_issues": 3,
      "warning_issues": 13
    },
    "phase_summary": {
      "phase1": {
        "status": "WARN",
        "critical_issues": 0,
        "warning_issues": 7,
        "total_issues": 7,
        "pass_rate": 25.0
      },
      "phase2": {
        "status": "FAIL",
        "critical_issues": 1,
        "warning_issues": 4,
        "total_issues": 5,
        "pass_rate": 50.0
      },
      "phase3": {
        "status": "FAIL",
        "critical_issues": 2,
        "warning_issues": 2,
        "total_issues": 4,
        "pass_rate": 60.0
      }
    },
    "key_findings": [
      "Source data quality concerns identified (25.0% tests passed)",
      "Database migration completed with high fidelity",
      "Mathematical consistency issues detected (67.1% accuracy)",
      "RTT performance standards: 4.8% compliance rate",
      "A&E performance standards: 20.9% compliance rate"
    ],
    "immediate_actions_required": true,
    "recommended_go_live_status": "HOLD_FOR_FIXES"
  },
  "detailed_findings": {
    "phase1": {
      "phase_name": "Phase 1: Source Data Verification",
      "execution_timestamp": "2025-09-24T07:05:01.414060",
      "overall_status": "WARN",
      "tests_performed": [
        "Raw data file completeness validation",
        "Unified CSV structure verification",
        "File integrity and readability checks",
        "Database connectivity testing"
      ],
      "issues_identified": [
        "Warning: Incomplete ae_data files - expected 12, found 11",
        "Found 4 duplicate trust-period records",
        "Corrupted Excel file: NHS Workforce Statistics, November 2024 England and Organisation.xlsx - Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.",
        "Corrupted Excel file: NHS Workforce Statistics, April 2025 Staff Group, Care Setting and Level.xlsx - Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.",
        "Corrupted Excel file: Community-health-services-waiting-lists-2024-25-August.xlsx - Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.",
        "Corrupted Excel file: CWT-CRS-Apr-2025-to-Jul-2025-Data-Extract-Provider.xlsx - Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.",
        "Corrupted Excel file: Community-health-services-waiting-lists-2024-25-March.xlsx - Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl."
      ],
      "test_results": {
        "raw_data_completeness": {
          "ae_data": {
            "expected_count": 12,
            "found_count": 11,
            "found_files": [
              "Monthly-AE-October-2024-revised.csv",
              "Monthly-AE-May-2025.csv",
              "Monthly-AE-June-2025-1-1.csv",
              "Monthly-AE-August-2024.csv",
              "Monthly-AE-February-2025-revised.csv",
              "Monthly-AE-December-2024.csv",
              "Monthly-AE-September-2024.csv",
              "Monthly-AE-March-2025.csv",
              "Monthly-AE-April-2025.csv",
              "Monthly-AE-January-2025.csv",
              "Monthly-AE-November-2024-revised.csv"
            ],
            "months_found": [
              "October-2024",
              "May-2025",
              "June-2025",
              "August-2024",
              "February-2025",
              "December-2024",
              "September-2024",
              "March-2025",
              "April-2025",
              "January-2025",
              "November-2024"
            ],
            "status": "WARN"
          },
          "rtt_data": {
            "expected_count": 12,
            "found_count": 12,
            "found_files": [
              "Incomplete-Provider-Dec24-XLSX-9M-revised.xlsx",
              "Incomplete-Provider-Sep24-XLSX-9M-revised.xlsx",
              "Incomplete-Provider-Apr25-XLSX-9M-77252.xlsx",
              "Incomplete-Provider-May25-XLSX-9M-32711.xlsx",
              "Incomplete-Provider-Nov24-XLSX-9M-revised.xlsx",
              "Incomplete-Provider-Jun25-XLSX-9M-94367.xlsx",
              "Incomplete-Provider-Jan25-XLSX-9M-revised.xlsx",
              "Incomplete-Provider-Oct24-XLSX-9M-revised.xlsx",
              "Incomplete-Provider-Jul25-XLSX-9M-92707 (1).xlsx",
              "Incomplete-Provider-Feb25-XLSX-9M-revised.xlsx",
              "Incomplete-Provider-Aug24-XLSX-9M-revised.xlsx",
              "Incomplete-Provider-Mar25-XLSX-9M-revised.xlsx"
            ],
            "months_found": [
              "Dec24",
              "Sep24",
              "Apr25",
              "May25",
              "Nov24",
              "Jun25",
              "Jan25",
              "Oct24",
              "Jul25",
              "Feb25",
              "Aug24",
              "Mar25"
            ],
            "status": "PASS"
          },
          "discharge_data": {
            "expected_count": 12,
            "found_count": 12,
            "found_files": [
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-March2025-revised.csv",
              "Daily-discharge-sitrep-monthly-data-webfile-October2024-csv-1.csv",
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-April2025-1.csv",
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-January2025-1.csv",
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-December2024.csv",
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-June2025.csv",
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-May2025.csv",
              "Daily-discharge-sitrep-monthly-data-webfile-August2024-revised.csv",
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-November2024.csv",
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-February2025-revised.csv",
              "Daily-discharge-sitrep-monthly-data-CSV-webfile-July2025v2.csv",
              "Daily-discharge-sitrep-monthly-data-webfile-September-2024.csv"
            ],
            "status": "PASS"
          },
          "other_data": {
            "Workforce": {
              "count": 30,
              "files": [
                "NHS Workforce Statistics, November 2024 England and Organisation.xlsx",
                "NHS Workforce Statistics, April 2025 Staff Group, Care Setting and Level.xlsx",
                "NHS Workforce Statistics, September 2024 Doctors by Grade and Specialty.xlsx",
                "NHS Workforce Statistics, December 2024 Staff Group, Care Setting and Level.xlsx",
                "NHS Workforce Statistics, January 2025 Doctors by Grade and Specialty.xlsx"
              ]
            },
            "Community Health": {
              "count": 12,
              "files": [
                "Community-health-services-waiting-lists-2024-25-August.xlsx",
                "Community-health-services-waiting-lists-2024-25-March.xlsx",
                "Community-health-services-waiting-lists-2024-25-September.xlsx",
                "Community-health-services-waiting-lists-2024-25-January.xlsx",
                "Community-health-services-waiting-lists-2025-26-June.xlsx"
              ]
            },
            "Diagnostics": {
              "count": 12,
              "files": [
                "Monthly-Diagnostics-Web-File-Provider-November-2024.xls",
                "Monthly-Diagnostics-Web-File-Provider-May-2025.xls",
                "Monthly-Diagnostics-Web-File-Provider-February-2025_FT49R.xls",
                "Monthly-Diagnostics-Web-File-Provider-September-2024.xls",
                "Monthly-Diagnostics-Web-File-Provider-August-2024.xls"
              ]
            },
            "Virtual Ward": {
              "count": 12,
              "files": [
                "Monthly-Virtual-Ward-June2025.xlsx",
                "Monthly-Virtual-Ward-July2025.xlsx",
                "Monthly-Virtual-Ward-Oct2024.xlsx",
                "Monthly-Virtual-Ward-Feb2025.xlsx",
                "Monthly-Virtual-Ward-Jan2025.xlsx"
              ]
            }
          }
        },
        "unified_csv": {
          "status": "WARN",
          "file_size_mb": 1.86,
          "total_records": 1816,
          "total_columns": 271,
          "unique_trusts": 151,
          "sample_trust_codes": [
            "R0A",
            "R0B",
            "R0D",
            "R1A",
            "R1D",
            "R1F",
            "R1H",
            "R1K",
            "RA2",
            "RA7"
          ],
          "unique_periods": 12,
          "period_range": "2024-08-01 to 2025-07-01",
          "duplicate_records": "4",
          "missing_columns": [],
          "present_expected_columns": [
            "trust_code",
            "trust_name",
            "period",
            "rtt_general_surgery_total_incomplete_pathways",
            "ae_attendances_total",
            "ae_4hr_performance_pct",
            "trust_total_total_incomplete_pathways",
            "trust_total_percent_within_18_weeks"
          ],
          "invalid_trust_codes": [],
          "date_format_valid": true,
          "date_format_error": null,
          "sample_data_analysis": {
            "ae_performance": {
              "count": 1433,
              "mean": 72.12,
              "min": 46.7,
              "max": 100.0,
              "out_of_range": 0
            },
            "rtt_performance": {
              "count": 1816,
              "mean": 63.39,
              "min": 29.94,
              "max": 100.0,
              "out_of_range": 1816
            }
          },
          "data_quality_checks": {
            "high_null_columns": {
              "rtt_restorative_dentistry_median_wait_weeks": 81.28,
              "rtt_medical_oncology_median_wait_weeks": 90.25,
              "avg_daily_discharges": 93.45,
              "diag_electrophysiology_13week_breaches": 85.9,
              "diag_electrophysiology_6week_breaches": 85.9,
              "diag_electrophysiology_planned_tests": 85.9,
              "diag_electrophysiology_total_waiting": 85.9,
              "diag_electrophysiology_unscheduled_tests": 85.9,
              "diag_electrophysiology_waiting_list_total": 85.9
            },
            "moderate_null_columns": {
              "rtt_pediatric_surgery_median_wait_weeks": 48.57,
              "rtt_cardiothoracic_surgery_median_wait_weeks": 77.37,
              "rtt_general_medicine_median_wait_weeks": 43.06,
              "rtt_dermatology_median_wait_weeks": 30.95,
              "rtt_neurology_median_wait_weeks": 39.76,
              "diag_nuclear_medicine_13week_breaches": 65.53,
              "diag_nuclear_medicine_6week_breaches": 65.53,
              "diag_nuclear_medicine_planned_tests": 65.53,
              "diag_nuclear_medicine_total_waiting": 65.53,
              "diag_nuclear_medicine_unscheduled_tests": 65.53,
              "diag_nuclear_medicine_waiting_list_total": 65.53,
              "diag_neurophysiology_13week_breaches": 36.18,
              "diag_neurophysiology_6week_breaches": 36.18,
              "diag_neurophysiology_planned_tests": 36.18,
              "diag_neurophysiology_total_waiting": 36.18,
              "diag_neurophysiology_unscheduled_tests": 36.18,
              "diag_neurophysiology_waiting_list_total": 36.18,
              "virtual_ward_capacity": 74.61,
              "virtual_ward_occupancy_rate": 74.61
            },
            "null_percentage_summary": {
              "columns_with_high_nulls": 9,
              "columns_with_moderate_nulls": 19,
              "average_null_rate": 12.65
            }
          },
          "validation_issues": [
            "Found 4 duplicate trust-period records"
          ]
        },
        "file_integrity": {
          "csv_files": {
            "readable": 10,
            "corrupted": 0,
            "files_tested": [
              {
                "file": "Daily-discharge-sitrep-monthly-data-CSV-webfile-March2025-revised.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 11,
                "size_mb": 5.94
              },
              {
                "file": "Daily-discharge-sitrep-monthly-data-webfile-October2024-csv-1.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 10,
                "size_mb": 5.73
              },
              {
                "file": "Daily-discharge-sitrep-monthly-data-CSV-webfile-April2025-1.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 10,
                "size_mb": 5.64
              },
              {
                "file": "Daily-discharge-sitrep-monthly-data-CSV-webfile-January2025-1.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 10,
                "size_mb": 5.7
              },
              {
                "file": "Daily-discharge-sitrep-monthly-data-CSV-webfile-December2024.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 10,
                "size_mb": 5.73
              },
              {
                "file": "Monthly-AE-October-2024-revised.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 22,
                "size_mb": 0.03
              },
              {
                "file": "Daily-discharge-sitrep-monthly-data-CSV-webfile-June2025.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 10,
                "size_mb": 5.47
              },
              {
                "file": "Daily-discharge-sitrep-monthly-data-CSV-webfile-May2025.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 10,
                "size_mb": 5.61
              },
              {
                "file": "unified_monthly_data_enhanced.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 271,
                "size_mb": 1.86
              },
              {
                "file": "Daily-discharge-sitrep-monthly-data-webfile-August2024-revised.csv",
                "status": "OK",
                "rows_sample": 5,
                "columns": 10,
                "size_mb": 5.73
              }
            ]
          },
          "excel_files": {
            "readable": 0,
            "corrupted": 5,
            "files_tested": [
              {
                "file": "NHS Workforce Statistics, November 2024 England and Organisation.xlsx",
                "status": "CORRUPTED",
                "error": "Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl."
              },
              {
                "file": "NHS Workforce Statistics, April 2025 Staff Group, Care Setting and Level.xlsx",
                "status": "CORRUPTED",
                "error": "Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl."
              },
              {
                "file": "Community-health-services-waiting-lists-2024-25-August.xlsx",
                "status": "CORRUPTED",
                "error": "Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl."
              },
              {
                "file": "CWT-CRS-Apr-2025-to-Jul-2025-Data-Extract-Provider.xlsx",
                "status": "CORRUPTED",
                "error": "Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl."
              },
              {
                "file": "Community-health-services-waiting-lists-2024-25-March.xlsx",
                "status": "CORRUPTED",
                "error": "Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl."
              }
            ]
          },
          "total_files_tested": 15
        },
        "database_connectivity": {
          "connection_status": "PASS",
          "connection_error": null,
          "table_exists": true,
          "record_count": 1766,
          "sample_records": [
            {
              "trust_code": "R0A",
              "trust_name": "MANCHESTER UNIVERSITY NHS FOUNDATION TRUST",
              "period": "2024-08-01",
              "rtt_data": {
                "specialties": {
                  "ent": {
                    "median_wait_weeks": 22.26,
                    "total_52_plus_weeks": 608,
                    "total_65_plus_weeks": 31,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 6818,
                    "total_within_18_weeks": 5016,
                    "percent_within_18_weeks": 0.42,
                    "total_incomplete_pathways": 11834
                  },
                  "urology": {
                    "median_wait_weeks": 21.45,
                    "total_52_plus_weeks": 565,
                    "total_65_plus_weeks": 23,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4022,
                    "total_within_18_weeks": 3157,
                    "percent_within_18_weeks": 0.44,
                    "total_incomplete_pathways": 7179
                  },
                  "neurology": {
                    "median_wait_weeks": 14.79,
                    "total_52_plus_weeks": 7,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 88,
                    "total_within_18_weeks": 127,
                    "percent_within_18_weeks": 0.59,
                    "total_incomplete_pathways": 215
                  },
                  "cardiology": {
                    "median_wait_weeks": 18.91,
                    "total_52_plus_weeks": 470,
                    "total_65_plus_weeks": 50,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 5413,
                    "total_within_18_weeks": 4923,
                    "percent_within_18_weeks": 0.48,
                    "total_incomplete_pathways": 10336
                  },
                  "gynecology": {
                    "median_wait_weeks": 24.61,
                    "total_52_plus_weeks": 2017,
                    "total_65_plus_weeks": 250,
                    "total_78_plus_weeks": 1,
                    "total_over_18_weeks": 11596,
                    "total_within_18_weeks": 7415,
                    "percent_within_18_weeks": 0.39,
                    "total_incomplete_pathways": 19011
                  },
                  "dermatology": {
                    "median_wait_weeks": 22.82,
                    "total_52_plus_weeks": 152,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 1639,
                    "total_within_18_weeks": 1168,
                    "percent_within_18_weeks": 0.42,
                    "total_incomplete_pathways": 2807
                  },
                  "oral_surgery": {
                    "median_wait_weeks": 24.42,
                    "total_52_plus_weeks": 1171,
                    "total_65_plus_weeks": 75,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 11898,
                    "total_within_18_weeks": 6781,
                    "percent_within_18_weeks": 0.36,
                    "total_incomplete_pathways": 18679
                  },
                  "rheumatology": {
                    "median_wait_weeks": 9.31,
                    "total_52_plus_weeks": 2,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 382,
                    "total_within_18_weeks": 1146,
                    "percent_within_18_weeks": 0.75,
                    "total_incomplete_pathways": 1528
                  },
                  "ophthalmology": {
                    "median_wait_weeks": 15.28,
                    "total_52_plus_weeks": 580,
                    "total_65_plus_weeks": 16,
                    "total_78_plus_weeks": 6,
                    "total_over_18_weeks": 5360,
                    "total_within_18_weeks": 6826,
                    "percent_within_18_weeks": 0.56,
                    "total_incomplete_pathways": 12186
                  },
                  "other_surgery": {
                    "median_wait_weeks": 16.04,
                    "total_52_plus_weeks": 885,
                    "total_65_plus_weeks": 99,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 11298,
                    "total_within_18_weeks": 13457,
                    "percent_within_18_weeks": 0.54,
                    "total_incomplete_pathways": 24755
                  },
                  "general_surgery": {
                    "median_wait_weeks": 22.02,
                    "total_52_plus_weeks": 669,
                    "total_65_plus_weeks": 54,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4063,
                    "total_within_18_weeks": 3008,
                    "percent_within_18_weeks": 0.43,
                    "total_incomplete_pathways": 7071
                  },
                  "gastroenterology": {
                    "median_wait_weeks": 16.37,
                    "total_52_plus_weeks": 222,
                    "total_65_plus_weeks": 11,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4874,
                    "total_within_18_weeks": 5478,
                    "percent_within_18_weeks": 0.53,
                    "total_incomplete_pathways": 10352
                  },
                  "general_medicine": {
                    "median_wait_weeks": 11.42,
                    "total_52_plus_weeks": 20,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 113,
                    "total_within_18_weeks": 260,
                    "percent_within_18_weeks": 0.7,
                    "total_incomplete_pathways": 373
                  },
                  "medical_oncology": {
                    "median_wait_weeks": null,
                    "total_52_plus_weeks": 0,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4,
                    "total_within_18_weeks": 6,
                    "percent_within_18_weeks": 0.6,
                    "total_incomplete_pathways": 10
                  },
                  "pediatric_surgery": {
                    "median_wait_weeks": 24.91,
                    "total_52_plus_weeks": 369,
                    "total_65_plus_weeks": 30,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 2652,
                    "total_within_18_weeks": 1532,
                    "percent_within_18_weeks": 0.37,
                    "total_incomplete_pathways": 4184
                  },
                  "geriatric_medicine": {
                    "median_wait_weeks": 15.37,
                    "total_52_plus_weeks": 11,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 487,
                    "total_within_18_weeks": 598,
                    "percent_within_18_weeks": 0.55,
                    "total_incomplete_pathways": 1085
                  },
                  "trauma_orthopaedics": {
                    "median_wait_weeks": 18.93,
                    "total_52_plus_weeks": 873,
                    "total_65_plus_weeks": 159,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 5006,
                    "total_within_18_weeks": 4715,
                    "percent_within_18_weeks": 0.49,
                    "total_incomplete_pathways": 9721
                  },
                  "respiratory_medicine": {
                    "median_wait_weeks": 15.22,
                    "total_52_plus_weeks": 164,
                    "total_65_plus_weeks": 1,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4291,
                    "total_within_18_weeks": 5754,
                    "percent_within_18_weeks": 0.57,
                    "total_incomplete_pathways": 10045
                  },
                  "restorative_dentistry": {
                    "median_wait_weeks": null,
                    "total_52_plus_weeks": 0,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 0,
                    "total_within_18_weeks": 0,
                    "percent_within_18_weeks": 0,
                    "total_incomplete_pathways": 0
                  },
                  "cardiothoracic_surgery": {
                    "median_wait_weeks": null,
                    "total_52_plus_weeks": 0,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 0,
                    "total_within_18_weeks": 0,
                    "percent_within_18_weeks": 0,
                    "total_incomplete_pathways": 0
                  }
                },
                "trust_total": {
                  "median_wait_weeks": 18.27,
                  "total_52_plus_weeks": 21098,
                  "total_65_plus_weeks": 1934,
                  "total_78_plus_weeks": 26,
                  "total_over_18_weeks": 200236,
                  "total_within_18_weeks": 185148,
                  "percent_within_18_weeks": 48.04,
                  "total_incomplete_pathways": 385384
                }
              },
              "ae_data": {
                "total_attendances": 35270,
                "over_four_hours_total": 9313,
                "four_hour_performance_pct": 73.6,
                "emergency_admissions_total": 5858,
                "twelve_hour_wait_admissions": 171
              }
            },
            {
              "trust_code": "R0A",
              "trust_name": "MANCHESTER UNIVERSITY NHS FOUNDATION TRUST",
              "period": "2024-09-01",
              "rtt_data": {
                "specialties": {
                  "ent": {
                    "median_wait_weeks": 21.55,
                    "total_52_plus_weeks": 645,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 6598,
                    "total_within_18_weeks": 5041,
                    "percent_within_18_weeks": 0.43,
                    "total_incomplete_pathways": 11639
                  },
                  "urology": {
                    "median_wait_weeks": 21.56,
                    "total_52_plus_weeks": 568,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4074,
                    "total_within_18_weeks": 3170,
                    "percent_within_18_weeks": 0.44,
                    "total_incomplete_pathways": 7244
                  },
                  "neurology": {
                    "median_wait_weeks": 16.6,
                    "total_52_plus_weeks": 7,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 104,
                    "total_within_18_weeks": 114,
                    "percent_within_18_weeks": 0.52,
                    "total_incomplete_pathways": 218
                  },
                  "cardiology": {
                    "median_wait_weeks": 18.67,
                    "total_52_plus_weeks": 356,
                    "total_65_plus_weeks": 7,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 5270,
                    "total_within_18_weeks": 4953,
                    "percent_within_18_weeks": 0.48,
                    "total_incomplete_pathways": 10223
                  },
                  "gynecology": {
                    "median_wait_weeks": 24,
                    "total_52_plus_weeks": 1853,
                    "total_65_plus_weeks": 106,
                    "total_78_plus_weeks": 4,
                    "total_over_18_weeks": 11573,
                    "total_within_18_weeks": 7566,
                    "percent_within_18_weeks": 0.4,
                    "total_incomplete_pathways": 19139
                  },
                  "dermatology": {
                    "median_wait_weeks": 23.12,
                    "total_52_plus_weeks": 146,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 1668,
                    "total_within_18_weeks": 1007,
                    "percent_within_18_weeks": 0.38,
                    "total_incomplete_pathways": 2675
                  },
                  "oral_surgery": {
                    "median_wait_weeks": 22.2,
                    "total_52_plus_weeks": 1207,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 11983,
                    "total_within_18_weeks": 8363,
                    "percent_within_18_weeks": 0.41,
                    "total_incomplete_pathways": 20346
                  },
                  "rheumatology": {
                    "median_wait_weeks": 11.24,
                    "total_52_plus_weeks": 2,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 450,
                    "total_within_18_weeks": 998,
                    "percent_within_18_weeks": 0.69,
                    "total_incomplete_pathways": 1448
                  },
                  "ophthalmology": {
                    "median_wait_weeks": 15.42,
                    "total_52_plus_weeks": 601,
                    "total_65_plus_weeks": 13,
                    "total_78_plus_weeks": 4,
                    "total_over_18_weeks": 5336,
                    "total_within_18_weeks": 6649,
                    "percent_within_18_weeks": 0.55,
                    "total_incomplete_pathways": 11985
                  },
                  "other_surgery": {
                    "median_wait_weeks": 16.08,
                    "total_52_plus_weeks": 656,
                    "total_65_plus_weeks": 16,
                    "total_78_plus_weeks": 2,
                    "total_over_18_weeks": 11231,
                    "total_within_18_weeks": 13297,
                    "percent_within_18_weeks": 0.54,
                    "total_incomplete_pathways": 24528
                  },
                  "general_surgery": {
                    "median_wait_weeks": 21.93,
                    "total_52_plus_weeks": 577,
                    "total_65_plus_weeks": 4,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 3958,
                    "total_within_18_weeks": 2985,
                    "percent_within_18_weeks": 0.43,
                    "total_incomplete_pathways": 6943
                  },
                  "gastroenterology": {
                    "median_wait_weeks": 16.78,
                    "total_52_plus_weeks": 191,
                    "total_65_plus_weeks": 2,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4988,
                    "total_within_18_weeks": 5480,
                    "percent_within_18_weeks": 0.52,
                    "total_incomplete_pathways": 10468
                  },
                  "general_medicine": {
                    "median_wait_weeks": 11.3,
                    "total_52_plus_weeks": 10,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 99,
                    "total_within_18_weeks": 266,
                    "percent_within_18_weeks": 0.73,
                    "total_incomplete_pathways": 365
                  },
                  "medical_oncology": {
                    "median_wait_weeks": null,
                    "total_52_plus_weeks": 1,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 5,
                    "total_within_18_weeks": 9,
                    "percent_within_18_weeks": 0.64,
                    "total_incomplete_pathways": 14
                  },
                  "pediatric_surgery": {
                    "median_wait_weeks": 24.63,
                    "total_52_plus_weeks": 402,
                    "total_65_plus_weeks": 1,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 2602,
                    "total_within_18_weeks": 1608,
                    "percent_within_18_weeks": 0.38,
                    "total_incomplete_pathways": 4210
                  },
                  "geriatric_medicine": {
                    "median_wait_weeks": 15.65,
                    "total_52_plus_weeks": 5,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 444,
                    "total_within_18_weeks": 603,
                    "percent_within_18_weeks": 0.58,
                    "total_incomplete_pathways": 1047
                  },
                  "trauma_orthopaedics": {
                    "median_wait_weeks": 17.82,
                    "total_52_plus_weeks": 747,
                    "total_65_plus_weeks": 62,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4909,
                    "total_within_18_weeks": 4959,
                    "percent_within_18_weeks": 0.5,
                    "total_incomplete_pathways": 9868
                  },
                  "respiratory_medicine": {
                    "median_wait_weeks": 15.72,
                    "total_52_plus_weeks": 191,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4502,
                    "total_within_18_weeks": 5490,
                    "percent_within_18_weeks": 0.55,
                    "total_incomplete_pathways": 9992
                  },
                  "restorative_dentistry": {
                    "median_wait_weeks": null,
                    "total_52_plus_weeks": 0,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 0,
                    "total_within_18_weeks": 0,
                    "percent_within_18_weeks": 0,
                    "total_incomplete_pathways": 0
                  },
                  "cardiothoracic_surgery": {
                    "median_wait_weeks": null,
                    "total_52_plus_weeks": 0,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 0,
                    "total_within_18_weeks": 0,
                    "percent_within_18_weeks": 0,
                    "total_incomplete_pathways": 0
                  }
                },
                "trust_total": {
                  "median_wait_weeks": 18.3,
                  "total_52_plus_weeks": 19530,
                  "total_65_plus_weeks": 498,
                  "total_78_plus_weeks": 26,
                  "total_over_18_weeks": 201132,
                  "total_within_18_weeks": 187830,
                  "percent_within_18_weeks": 48.29,
                  "total_incomplete_pathways": 388962
                }
              },
              "ae_data": {
                "total_attendances": 37841,
                "over_four_hours_total": 11366,
                "four_hour_performance_pct": 69.96,
                "emergency_admissions_total": 5757,
                "twelve_hour_wait_admissions": 179
              }
            },
            {
              "trust_code": "R0A",
              "trust_name": "MANCHESTER UNIVERSITY NHS FOUNDATION TRUST",
              "period": "2024-10-01",
              "rtt_data": {
                "specialties": {
                  "ent": {
                    "median_wait_weeks": 21.3,
                    "total_52_plus_weeks": 583,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 6616,
                    "total_within_18_weeks": 5118,
                    "percent_within_18_weeks": 0.44,
                    "total_incomplete_pathways": 11734
                  },
                  "urology": {
                    "median_wait_weeks": 20.65,
                    "total_52_plus_weeks": 465,
                    "total_65_plus_weeks": 2,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4068,
                    "total_within_18_weeks": 3316,
                    "percent_within_18_weeks": 0.45,
                    "total_incomplete_pathways": 7384
                  },
                  "neurology": {
                    "median_wait_weeks": 18.43,
                    "total_52_plus_weeks": 11,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 119,
                    "total_within_18_weeks": 113,
                    "percent_within_18_weeks": 0.49,
                    "total_incomplete_pathways": 232
                  },
                  "cardiology": {
                    "median_wait_weeks": 18.28,
                    "total_52_plus_weeks": 271,
                    "total_65_plus_weeks": 3,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 5087,
                    "total_within_18_weeks": 4956,
                    "percent_within_18_weeks": 0.49,
                    "total_incomplete_pathways": 10043
                  },
                  "gynecology": {
                    "median_wait_weeks": 23.38,
                    "total_52_plus_weeks": 1792,
                    "total_65_plus_weeks": 142,
                    "total_78_plus_weeks": 3,
                    "total_over_18_weeks": 11667,
                    "total_within_18_weeks": 7864,
                    "percent_within_18_weeks": 0.4,
                    "total_incomplete_pathways": 19531
                  },
                  "dermatology": {
                    "median_wait_weeks": 22.84,
                    "total_52_plus_weeks": 143,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 1577,
                    "total_within_18_weeks": 1056,
                    "percent_within_18_weeks": 0.4,
                    "total_incomplete_pathways": 2633
                  },
                  "oral_surgery": {
                    "median_wait_weeks": 21.59,
                    "total_52_plus_weeks": 1094,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 11987,
                    "total_within_18_weeks": 8442,
                    "percent_within_18_weeks": 0.41,
                    "total_incomplete_pathways": 20429
                  },
                  "rheumatology": {
                    "median_wait_weeks": 12.14,
                    "total_52_plus_weeks": 0,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 509,
                    "total_within_18_weeks": 976,
                    "percent_within_18_weeks": 0.66,
                    "total_incomplete_pathways": 1485
                  },
                  "ophthalmology": {
                    "median_wait_weeks": 15.24,
                    "total_52_plus_weeks": 549,
                    "total_65_plus_weeks": 18,
                    "total_78_plus_weeks": 3,
                    "total_over_18_weeks": 5232,
                    "total_within_18_weeks": 6570,
                    "percent_within_18_weeks": 0.56,
                    "total_incomplete_pathways": 11802
                  },
                  "other_surgery": {
                    "median_wait_weeks": 16.36,
                    "total_52_plus_weeks": 768,
                    "total_65_plus_weeks": 16,
                    "total_78_plus_weeks": 1,
                    "total_over_18_weeks": 11461,
                    "total_within_18_weeks": 13405,
                    "percent_within_18_weeks": 0.54,
                    "total_incomplete_pathways": 24866
                  },
                  "general_surgery": {
                    "median_wait_weeks": 21.74,
                    "total_52_plus_weeks": 554,
                    "total_65_plus_weeks": 4,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4147,
                    "total_within_18_weeks": 3064,
                    "percent_within_18_weeks": 0.42,
                    "total_incomplete_pathways": 7211
                  },
                  "gastroenterology": {
                    "median_wait_weeks": 17.06,
                    "total_52_plus_weeks": 317,
                    "total_65_plus_weeks": 1,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 5368,
                    "total_within_18_weeks": 5776,
                    "percent_within_18_weeks": 0.52,
                    "total_incomplete_pathways": 11144
                  },
                  "general_medicine": {
                    "median_wait_weeks": 10.82,
                    "total_52_plus_weeks": 10,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 86,
                    "total_within_18_weeks": 242,
                    "percent_within_18_weeks": 0.74,
                    "total_incomplete_pathways": 328
                  },
                  "medical_oncology": {
                    "median_wait_weeks": 11.5,
                    "total_52_plus_weeks": 1,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 6,
                    "total_within_18_weeks": 15,
                    "percent_within_18_weeks": 0.71,
                    "total_incomplete_pathways": 21
                  },
                  "pediatric_surgery": {
                    "median_wait_weeks": 24.04,
                    "total_52_plus_weeks": 381,
                    "total_65_plus_weeks": 3,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 2590,
                    "total_within_18_weeks": 1705,
                    "percent_within_18_weeks": 0.4,
                    "total_incomplete_pathways": 4295
                  },
                  "geriatric_medicine": {
                    "median_wait_weeks": 14.94,
                    "total_52_plus_weeks": 1,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 430,
                    "total_within_18_weeks": 590,
                    "percent_within_18_weeks": 0.58,
                    "total_incomplete_pathways": 1020
                  },
                  "trauma_orthopaedics": {
                    "median_wait_weeks": 17.16,
                    "total_52_plus_weeks": 673,
                    "total_65_plus_weeks": 74,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4944,
                    "total_within_18_weeks": 5302,
                    "percent_within_18_weeks": 0.52,
                    "total_incomplete_pathways": 10246
                  },
                  "respiratory_medicine": {
                    "median_wait_weeks": 17.11,
                    "total_52_plus_weeks": 252,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 4749,
                    "total_within_18_weeks": 5184,
                    "percent_within_18_weeks": 0.52,
                    "total_incomplete_pathways": 9933
                  },
                  "restorative_dentistry": {
                    "median_wait_weeks": null,
                    "total_52_plus_weeks": 0,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 0,
                    "total_within_18_weeks": 0,
                    "percent_within_18_weeks": 0,
                    "total_incomplete_pathways": 0
                  },
                  "cardiothoracic_surgery": {
                    "median_wait_weeks": null,
                    "total_52_plus_weeks": 0,
                    "total_65_plus_weeks": 0,
                    "total_78_plus_weeks": 0,
                    "total_over_18_weeks": 0,
                    "total_within_18_weeks": 1,
                    "percent_within_18_weeks": 1,
                    "total_incomplete_pathways": 1
                  }
                },
                "trust_total": {
                  "median_wait_weeks": 17.99,
                  "total_52_plus_weeks": 19012,
                  "total_65_plus_weeks": 560,
                  "total_78_plus_weeks": 14,
                  "total_over_18_weeks": 203646,
                  "total_within_18_weeks": 190326,
                  "percent_within_18_weeks": 48.31,
                  "total_incomplete_pathways": 393972
                }
              },
              "ae_data": {
                "total_attendances": 40781,
                "over_four_hours_total": 12827,
                "four_hour_performance_pct": 68.55,
                "emergency_admissions_total": 6248,
                "twelve_hour_wait_admissions": 278
              }
            }
          ],
          "table_structure": {}
        }
      },
      "recommendations": [
        "\ud83d\udfe1 Warning issues found - review before proceeding to Phase 2",
        "Consider data quality improvements for better accuracy"
      ],
      "key_metrics": {
        "records_validated": 1816,
        "columns_validated": 271,
        "trusts_identified": 151,
        "duplicate_records": "4"
      }
    },
    "phase2": {
      "phase_name": "Phase 2: Database Migration Integrity",
      "execution_timestamp": "2025-09-24T07:07:27.585671",
      "overall_status": "FAIL",
      "tests_performed": [
        "Database record completeness verification",
        "JSONB structure integrity validation",
        "Data transformation accuracy testing",
        "Cross-validation with source data"
      ],
      "issues_identified": [
        "Minor record count difference: CSV 1816 vs DB 1766",
        "Missing 67 trusts in database: ['RYW', 'RWW', 'RTF', 'RP5', 'RRE']",
        "Missing 5 periods in database: ['2025-06-01', '2025-04-01', '2025-07-01', '2025-05-01', '2025-03-01']",
        "Warning: 2 trusts have inconsistent names between CSV and database",
        "Critical: Cross-validation failed - '>' not supported between instances of 'Timedelta' and 'DateOffset'"
      ],
      "test_results": {
        "database_completeness": {
          "csv_total_records": 1816,
          "csv_unique_trusts": 151,
          "csv_unique_periods": 12,
          "csv_period_range": "2024-08-01 to 2025-07-01",
          "db_total_records": 1766,
          "db_unique_trusts": 84,
          "db_unique_periods": 7,
          "db_period_range": "2024-08-01 to 2025-02-01",
          "missing_trusts": [
            "RYW",
            "RWW",
            "RTF",
            "RP5",
            "RRE",
            "RTE",
            "RP6",
            "RTP",
            "RR7",
            "RNZ",
            "RTG",
            "RXQ",
            "RYY",
            "RTD",
            "RX4",
            "RWX",
            "RXG",
            "RTX",
            "RR8",
            "RXK",
            "RPG",
            "RQX",
            "RTR",
            "RVW",
            "RQ3",
            "RQM",
            "RPY",
            "RXF",
            "RRK",
            "RVJ",
            "RQW",
            "RP4",
            "RX1",
            "RYR",
            "RTH",
            "RRJ",
            "RXR",
            "RVV",
            "RWE",
            "RWF",
            "RWH",
            "RWA",
            "RPC",
            "RWD",
            "RXC",
            "RP7",
            "RW4",
            "RRV",
            "RW5",
            "RPA",
            "RW1",
            "RYJ",
            "RRF",
            "RWY",
            "RWP",
            "RT1",
            "RTK",
            "RXL",
            "RXN",
            "TAD",
            "RNQ",
            "RXW",
            "RNS",
            "RVR",
            "RXP",
            "RWJ",
            "RWG"
          ],
          "extra_trusts": [],
          "missing_periods": [
            "2025-06-01",
            "2025-04-01",
            "2025-07-01",
            "2025-05-01",
            "2025-03-01"
          ],
          "extra_periods": [],
          "record_count_match": false,
          "trust_count_match": false,
          "period_count_match": false,
          "status": "WARN",
          "issues": [
            "Minor record count difference: CSV 1816 vs DB 1766",
            "Missing 67 trusts in database: ['RYW', 'RWW', 'RTF', 'RP5', 'RRE']",
            "Missing 5 periods in database: ['2025-06-01', '2025-04-01', '2025-07-01', '2025-05-01', '2025-03-01']"
          ]
        },
        "jsonb_structure": {
          "sample_size": 50,
          "fields_analyzed": [
            "rtt_data",
            "ae_data",
            "diagnostics_data",
            "capacity_data"
          ],
          "structure_analysis": {
            "rtt_data": {
              "total_records": 50,
              "populated_count": 50,
              "empty_count": 0,
              "empty_string_count": 0,
              "null_count": 0,
              "valid_json_count": 50,
              "invalid_json_count": 0,
              "structure_examples": [
                {
                  "trust_code": "R0A",
                  "keys": [
                    "specialties",
                    "trust_total"
                  ],
                  "key_count": 2
                },
                {
                  "trust_code": "R0A",
                  "keys": [
                    "specialties",
                    "trust_total"
                  ],
                  "key_count": 2
                },
                {
                  "trust_code": "R0A",
                  "keys": [
                    "specialties",
                    "trust_total"
                  ],
                  "key_count": 2
                }
              ],
              "populated_percentage": 100.0,
              "empty_string_percentage": 0.0
            },
            "ae_data": {
              "total_records": 50,
              "populated_count": 50,
              "empty_count": 0,
              "empty_string_count": 0,
              "null_count": 0,
              "valid_json_count": 50,
              "invalid_json_count": 0,
              "structure_examples": [
                {
                  "trust_code": "R0A",
                  "keys": [
                    "total_attendances",
                    "over_four_hours_total",
                    "four_hour_performance_pct",
                    "emergency_admissions_total",
                    "twelve_hour_wait_admissions"
                  ],
                  "key_count": 5
                },
                {
                  "trust_code": "R0A",
                  "keys": [
                    "total_attendances",
                    "over_four_hours_total",
                    "four_hour_performance_pct",
                    "emergency_admissions_total",
                    "twelve_hour_wait_admissions"
                  ],
                  "key_count": 5
                },
                {
                  "trust_code": "R0A",
                  "keys": [
                    "total_attendances",
                    "over_four_hours_total",
                    "four_hour_performance_pct",
                    "emergency_admissions_total",
                    "twelve_hour_wait_admissions"
                  ],
                  "key_count": 5
                }
              ],
              "populated_percentage": 100.0,
              "empty_string_percentage": 0.0
            },
            "diagnostics_data": {
              "total_records": 50,
              "populated_count": 50,
              "empty_count": 0,
              "empty_string_count": 0,
              "null_count": 0,
              "valid_json_count": 50,
              "invalid_json_count": 0,
              "structure_examples": [
                {
                  "trust_code": "R0A",
                  "keys": [
                    "ct",
                    "mri",
                    "dexa",
                    "audiology",
                    "cystoscopy",
                    "ultrasound",
                    "colonoscopy",
                    "gastroscopy",
                    "urodynamics",
                    "sigmoidoscopy",
                    "sleep_studies",
                    "neurophysiology",
                    "echocardiography",
                    "nuclear_medicine",
                    "electrophysiology"
                  ],
                  "key_count": 15
                },
                {
                  "trust_code": "R0A",
                  "keys": [
                    "ct",
                    "mri",
                    "dexa",
                    "audiology",
                    "cystoscopy",
                    "ultrasound",
                    "colonoscopy",
                    "gastroscopy",
                    "urodynamics",
                    "sigmoidoscopy",
                    "sleep_studies",
                    "neurophysiology",
                    "echocardiography",
                    "nuclear_medicine",
                    "electrophysiology"
                  ],
                  "key_count": 15
                },
                {
                  "trust_code": "R0A",
                  "keys": [
                    "ct",
                    "mri",
                    "dexa",
                    "audiology",
                    "cystoscopy",
                    "ultrasound",
                    "colonoscopy",
                    "gastroscopy",
                    "urodynamics",
                    "sigmoidoscopy",
                    "sleep_studies",
                    "neurophysiology",
                    "echocardiography",
                    "nuclear_medicine",
                    "electrophysiology"
                  ],
                  "key_count": 15
                }
              ],
              "populated_percentage": 100.0,
              "empty_string_percentage": 0.0
            },
            "capacity_data": {
              "total_records": 50,
              "populated_count": 50,
              "empty_count": 0,
              "empty_string_count": 0,
              "null_count": 0,
              "valid_json_count": 50,
              "invalid_json_count": 0,
              "structure_examples": [
                {
                  "trust_code": "R0A",
                  "keys": [
                    "avg_daily_discharges",
                    "virtual_ward_capacity",
                    "virtual_ward_occupancy_rate"
                  ],
                  "key_count": 3
                },
                {
                  "trust_code": "R0A",
                  "keys": [
                    "avg_daily_discharges",
                    "virtual_ward_capacity",
                    "virtual_ward_occupancy_rate"
                  ],
                  "key_count": 3
                },
                {
                  "trust_code": "R0A",
                  "keys": [
                    "avg_daily_discharges",
                    "virtual_ward_capacity",
                    "virtual_ward_occupancy_rate"
                  ],
                  "key_count": 3
                }
              ],
              "populated_percentage": 100.0,
              "empty_string_percentage": 0.0
            }
          },
          "empty_field_analysis": {},
          "data_type_analysis": {},
          "actual_sample_size": 50,
          "overall_status": "PASS",
          "average_populated_percentage": 100.0
        },
        "transformation_accuracy": {
          "sample_size": 25,
          "samples_tested": [
            {
              "trust_code": "RWA",
              "period": "2024-10-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 14647.0,
                  "db_value": 14647,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 58.94,
                  "db_value": 58.94,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 57.2,
                  "db_value": 57.2,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "160974",
                  "db_value": 160974,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RKE",
              "period": "2024-11-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 9302.0,
                  "db_value": 9302,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 70.81,
                  "db_value": 70.81,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 65.42,
                  "db_value": 65.42,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "50654",
                  "db_value": 50654,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RWX",
              "period": "2025-01-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 1264.0,
                  "db_value": 1264,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 98.73,
                  "db_value": 98.73,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 100.0,
                  "db_value": 100,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "166",
                  "db_value": 166,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RWJ",
              "period": "2024-09-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 8843.0,
                  "db_value": 8843,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 59.99,
                  "db_value": 59.99,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 52.52,
                  "db_value": 52.52,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "73730",
                  "db_value": 73730,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RHQ",
              "period": "2025-05-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 17537.0,
                  "db_value": 17537,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 72.7,
                  "db_value": 72.7,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 65.27,
                  "db_value": 65.27,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "184074",
                  "db_value": 184074,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RNN",
              "period": "2024-08-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 10394.0,
                  "db_value": 10394,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 68.19,
                  "db_value": 68.19,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 59.48,
                  "db_value": 59.48,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "76432",
                  "db_value": 76432,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "R1A",
              "period": "2025-06-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": NaN,
                  "db_value": null,
                  "accurate": true,
                  "notes": [
                    "Both values are null/empty"
                  ]
                },
                "ae_4hr_performance_pct": {
                  "csv_value": NaN,
                  "db_value": null,
                  "accurate": true,
                  "notes": [
                    "Both values are null/empty"
                  ]
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 97.48,
                  "db_value": 97.48,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "238",
                  "db_value": 238,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RJ7",
              "period": "2024-10-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 12650.0,
                  "db_value": 12650,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 78.06,
                  "db_value": 78.06,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 63.16,
                  "db_value": 63.16,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "134926",
                  "db_value": 134926,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RBT",
              "period": "2025-06-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 10154.0,
                  "db_value": 10154,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 58.9,
                  "db_value": 58.9,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 55.71,
                  "db_value": 55.71,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "78426",
                  "db_value": 78426,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RNN",
              "period": "2025-05-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 11369.0,
                  "db_value": 11369,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 66.49,
                  "db_value": 66.49,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 56.64,
                  "db_value": 56.64,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "76132",
                  "db_value": 76132,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RTK",
              "period": "2024-09-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 9511.0,
                  "db_value": 9511,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 67.57,
                  "db_value": 67.57,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 60.45,
                  "db_value": 60.45,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "116204",
                  "db_value": 116204,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RXR",
              "period": "2025-06-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 24311.0,
                  "db_value": 24311,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 80.03,
                  "db_value": 80.03,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 60.69,
                  "db_value": 60.69,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "116374",
                  "db_value": 116374,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RDR",
              "period": "2025-01-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 11327.0,
                  "db_value": 11327,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 99.23,
                  "db_value": 99.23,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 73.74,
                  "db_value": 73.74,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "21040",
                  "db_value": 21040,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RA7",
              "period": "2024-11-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 18761.0,
                  "db_value": 18761,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 64.83,
                  "db_value": 64.83,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 62.82,
                  "db_value": 62.82,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "109996",
                  "db_value": 109996,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RHM",
              "period": "2025-02-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 11906.0,
                  "db_value": 11906,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 57.51,
                  "db_value": 57.51,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 61.5,
                  "db_value": 61.5,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "122656",
                  "db_value": 122656,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RLT",
              "period": "2025-05-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 8193.0,
                  "db_value": 8193,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 68.22,
                  "db_value": 68.22,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 58.31,
                  "db_value": 58.31,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "41148",
                  "db_value": 41148,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RBT",
              "period": "2025-01-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 9342.0,
                  "db_value": 9342,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 56.49,
                  "db_value": 56.49,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 52.9,
                  "db_value": 52.9,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "75392",
                  "db_value": 75392,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RAL",
              "period": "2024-08-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 23693.0,
                  "db_value": 23693,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 76.61,
                  "db_value": 76.61,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 57.13,
                  "db_value": 57.13,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "218368",
                  "db_value": 218368,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RTP",
              "period": "2024-12-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 11305.0,
                  "db_value": 11305,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 55.42,
                  "db_value": 55.42,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 59.29,
                  "db_value": 59.29,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "99696",
                  "db_value": 99696,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RJ6",
              "period": "2025-04-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 17535.0,
                  "db_value": 17535,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 79.13,
                  "db_value": 79.13,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 68.36,
                  "db_value": 68.36,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "68860",
                  "db_value": 68860,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RXG",
              "period": "2025-01-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 0.0,
                  "db_value": 0,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": NaN,
                  "db_value": null,
                  "accurate": true,
                  "notes": [
                    "Both values are null/empty"
                  ]
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 97.17,
                  "db_value": 97.17,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "8276",
                  "db_value": 8276,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RET",
              "period": "2025-01-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 0.0,
                  "db_value": 0,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": NaN,
                  "db_value": null,
                  "accurate": true,
                  "notes": [
                    "Both values are null/empty"
                  ]
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 58.4,
                  "db_value": 58.4,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "31128",
                  "db_value": 31128,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "REF",
              "period": "2025-02-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 15886.0,
                  "db_value": 15886,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 77.33,
                  "db_value": 77.33,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 69.05,
                  "db_value": 69.05,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "82108",
                  "db_value": 82108,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            },
            {
              "trust_code": "RMP",
              "period": "2024-12-01",
              "field_comparisons": {
                "ae_attendances_total": {
                  "csv_value": 12329.0,
                  "db_value": 12329,
                  "accurate": true,
                  "notes": []
                },
                "ae_4hr_performance_pct": {
                  "csv_value": 61.06,
                  "db_value": 61.06,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_percent_within_18_weeks": {
                  "csv_value": 68.97,
                  "db_value": 68.97,
                  "accurate": true,
                  "notes": []
                },
                "trust_total_total_incomplete_pathways": {
                  "csv_value": "36306",
                  "db_value": 36306,
                  "accurate": true,
                  "notes": []
                }
              },
              "accurate_fields": 4,
              "total_fields": 4,
              "overall_accuracy": 1.0
            }
          ],
          "transformation_accuracy": {},
          "value_comparisons": [],
          "failed_transformations": [
            {
              "trust_code": "RVW",
              "period": "2025-02-01",
              "error": "Record not found in database"
            }
          ],
          "actual_sample_size": 25,
          "overall_accuracy": 100.0,
          "status": "PASS"
        },
        "cross_validation": {
          "trust_name_consistency": {
            "total_trusts_checked": 151,
            "inconsistent_names": 2,
            "inconsistent_details": [
              [
                "RAX",
                {
                  "csv_name": "KINGSTON AND RICHMOND NHS FOUNDATION TRUST",
                  "db_name": "KINGSTON HOSPITAL NHS FOUNDATION TRUST"
                }
              ],
              [
                "RHU",
                {
                  "csv_name": "PORTSMOUTH HOSPITALS UNIVERSITY NHS TRUST",
                  "db_name": "PORTSMOUTH HOSPITALS UNIVERSITY NATIONAL HEALTH SERVICE TRUST"
                }
              ]
            ]
          },
          "period_continuity": {},
          "data_relationships": {},
          "completeness_analysis": {},
          "overall_status": "FAIL",
          "error": "'>' not supported between instances of 'Timedelta' and 'DateOffset'"
        }
      },
      "recommendations": [
        "\ud83d\udd34 Critical database migration issues found - requires immediate attention",
        "Review data transformation pipeline for systematic errors",
        "Verify all source data is being processed correctly"
      ],
      "key_metrics": {
        "migration_completeness": "1766/1816 records",
        "trust_migration": "84/151 trusts",
        "period_migration": "7/12 periods"
      }
    },
    "phase3": {
      "phase_name": "Phase 3: Business Logic Validation",
      "execution_timestamp": "2025-09-24T07:10:51.751560",
      "overall_status": "FAIL",
      "tests_performed": [
        "NHS performance standards compliance testing",
        "Mathematical consistency validation",
        "Data range and outlier detection",
        "Temporal consistency analysis",
        "Business rule compliance verification"
      ],
      "issues_identified": [
        "Warning: Low RTT compliance rate (4.8%)",
        "Warning: Very low A&E compliance rate (20.9%)",
        "Critical: Low mathematical consistency (67.1%)",
        "Critical: 12 temporal consistency issues found"
      ],
      "test_results": {
        "nhs_performance_standards": {
          "rtt_18_week_standard": {
            "target": 92.0,
            "violations": [
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-08-01",
                "performance": 48.04,
                "shortfall": 43.96
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-09-01",
                "performance": 48.29,
                "shortfall": 43.71
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-10-01",
                "performance": 48.31,
                "shortfall": 43.69
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-11-01",
                "performance": 48.16,
                "shortfall": 43.84
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-12-01",
                "performance": 48.25,
                "shortfall": 43.75
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2025-01-01",
                "performance": 49.64,
                "shortfall": 42.36
              },
              {
                "trust_code": "RGR",
                "trust_name": "WEST SUFFOLK NHS FOUNDATION TR...",
                "period": "2024-10-01",
                "performance": 59.89,
                "shortfall": 32.11
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2025-02-01",
                "performance": 50.42,
                "shortfall": 41.58
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2025-03-01",
                "performance": 51.44,
                "shortfall": 40.56
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2025-04-01",
                "performance": 51.04,
                "shortfall": 40.96
              }
            ],
            "violation_count": 952
          },
          "ae_4_hour_standard": {
            "target": 95.0,
            "violations": [
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-08-01",
                "performance": 73.6,
                "shortfall": 21.4
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-09-01",
                "performance": 69.96,
                "shortfall": 25.04
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-10-01",
                "performance": 68.55,
                "shortfall": 26.45
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-11-01",
                "performance": 64.24,
                "shortfall": 30.76
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2024-12-01",
                "performance": 64.77,
                "shortfall": 30.23
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2025-01-01",
                "performance": 67.3,
                "shortfall": 27.7
              },
              {
                "trust_code": "RGR",
                "trust_name": "WEST SUFFOLK NHS FOUNDATION TR...",
                "period": "2024-10-01",
                "performance": 64.63,
                "shortfall": 30.37
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2025-02-01",
                "performance": 69.45,
                "shortfall": 25.55
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2025-03-01",
                "performance": 73.75,
                "shortfall": 21.25
              },
              {
                "trust_code": "R0A",
                "trust_name": "MANCHESTER UNIVERSITY NHS FOUN...",
                "period": "2025-04-01",
                "performance": 70.62,
                "shortfall": 24.38
              }
            ],
            "violation_count": 791
          },
          "diagnostic_6_week_standard": {
            "target": 99.0,
            "violations": [],
            "violation_count": 0
          },
          "ambulance_response_standards": {
            "violations": []
          },
          "compliance_summary": {
            "total_trust_periods": 1000,
            "rtt_compliant": 48,
            "ae_compliant": 209,
            "diagnostic_compliant": 1000,
            "rtt_compliance_rate": 4.8,
            "ae_compliance_rate": 20.9,
            "diagnostic_compliance_rate": 100.0
          },
          "status": "PASS"
        },
        "mathematical_consistency": {
          "rtt_specialty_totals": {
            "tests": 1000,
            "violations": [
              {
                "trust_code": "R0A",
                "period": "2024-08-01",
                "trust_total": 385384,
                "specialty_sum": 151371,
                "difference": 234013,
                "difference_pct": 60.72
              },
              {
                "trust_code": "R0A",
                "period": "2024-09-01",
                "trust_total": 388962,
                "specialty_sum": 152352,
                "difference": 236610,
                "difference_pct": 60.83
              },
              {
                "trust_code": "R0A",
                "period": "2024-10-01",
                "trust_total": 393972,
                "specialty_sum": 154338,
                "difference": 239634,
                "difference_pct": 60.83
              },
              {
                "trust_code": "R0A",
                "period": "2024-11-01",
                "trust_total": 399156,
                "specialty_sum": 154930,
                "difference": 244226,
                "difference_pct": 61.19
              },
              {
                "trust_code": "R0A",
                "period": "2024-12-01",
                "trust_total": 398850,
                "specialty_sum": 159376,
                "difference": 239474,
                "difference_pct": 60.04
              }
            ],
            "violation_count": 987
          },
          "ae_attendance_totals": {
            "tests": 0,
            "violations": []
          },
          "percentage_calculations": {
            "tests": 1000,
            "violations": [],
            "violation_count": 0
          },
          "waiting_list_mathematics": {
            "tests": 1000,
            "violations": [],
            "violation_count": 0
          },
          "overall_accuracy_rate": 67.1,
          "status": "FAIL"
        },
        "outlier_detection": {
          "performance_percentages": {
            "tests": 1000,
            "outliers": [],
            "outlier_count": 0
          },
          "waiting_times": {
            "tests": 1000,
            "outliers": [],
            "outlier_count": 0
          },
          "attendance_volumes": {
            "tests": 815,
            "outliers": [],
            "outlier_count": 0
          },
          "statistical_outliers": {
            "tests": 0,
            "outliers": []
          },
          "overall_outlier_rate": 0.0,
          "status": "PASS"
        },
        "temporal_consistency": {
          "period_coverage": {
            "total_trusts": 92,
            "expected_periods": 12,
            "period_range": "2024-08-01 to 2025-07-01",
            "trusts_with_gaps": 12,
            "coverage_issues": [
              {
                "trust_code": "RP7",
                "missing_periods": 10,
                "total_expected": 12,
                "coverage_rate": 16.7
              },
              {
                "trust_code": "RNN",
                "missing_periods": 10,
                "total_expected": 12,
                "coverage_rate": 16.7
              },
              {
                "trust_code": "RW4",
                "missing_periods": 11,
                "total_expected": 12,
                "coverage_rate": 8.3
              },
              {
                "trust_code": "RPA",
                "missing_periods": 8,
                "total_expected": 12,
                "coverage_rate": 33.3
              },
              {
                "trust_code": "RPC",
                "missing_periods": 11,
                "total_expected": 12,
                "coverage_rate": 8.3
              },
              {
                "trust_code": "RQ3",
                "missing_periods": 10,
                "total_expected": 12,
                "coverage_rate": 16.7
              },
              {
                "trust_code": "RR8",
                "missing_periods": 7,
                "total_expected": 12,
                "coverage_rate": 41.7
              },
              {
                "trust_code": "RRK",
                "missing_periods": 9,
                "total_expected": 12,
                "coverage_rate": 25.0
              },
              {
                "trust_code": "RT1",
                "missing_periods": 11,
                "total_expected": 12,
                "coverage_rate": 8.3
              },
              {
                "trust_code": "RTE",
                "missing_periods": 6,
                "total_expected": 12,
                "coverage_rate": 50.0
              }
            ]
          },
          "trend_analysis": {
            "trusts_analyzed": 86,
            "trend_violations": 0,
            "violation_details": []
          },
          "seasonal_patterns": {},
          "data_continuity": {},
          "status": "FAIL"
        },
        "business_rule_compliance": {
          "rules_tested": [
            {
              "rule_name": "Long wait hierarchies (52+ weeks \u2264 18+ weeks)",
              "tests_performed": 1000,
              "violations": 0,
              "compliance_rate": 100.0
            },
            {
              "rule_name": "A&E attendance logic (breaches \u2264 total attendances)",
              "tests_performed": 815,
              "violations": 0,
              "compliance_rate": 100.0
            },
            {
              "rule_name": "Diagnostic wait hierarchy (13wk \u2264 6wk \u2264 total)",
              "tests_performed": 1000,
              "violations": 0,
              "compliance_rate": 100.0
            }
          ],
          "violations": [],
          "compliance_summary": {
            "total_tests": 2815,
            "total_violations": 0,
            "overall_compliance_rate": 100.0
          },
          "status": "PASS"
        }
      },
      "recommendations": [
        "\ud83d\udd34 Critical business logic violations found - requires data quality review",
        "Review data transformation and validation processes",
        "Implement additional business rule checks in data pipeline",
        "Review mathematical calculations in data transformation"
      ],
      "key_metrics": {
        "mathematical_accuracy": "67.1%",
        "rtt_compliance": "4.8%",
        "ae_compliance": "20.9%"
      }
    }
  },
  "data_quality_assessment": {
    "overall_quality_score": 92.6,
    "overall_quality_grade": "A (Excellent)",
    "quality_dimensions": {
      "completeness": {
        "score": 97.2,
        "weight": 0.3,
        "findings": [
          "Source file completeness: 97.2%"
        ]
      },
      "accuracy": {
        "score": 100.0,
        "weight": 0.3,
        "findings": [
          "Data transformation accuracy: 100.0%"
        ]
      },
      "consistency": {
        "score": 100.0,
        "weight": 0.2,
        "findings": [
          "JSONB field population: 100.0%"
        ]
      },
      "validity": {
        "score": 67.1,
        "weight": 0.2,
        "findings": [
          "Mathematical consistency: 67.1%",
          "Business rule compliance: 100.0%"
        ]
      }
    },
    "quality_summary": [
      "Data quality is suitable for production dashboard deployment",
      "Validity dimension needs attention (67.1% score)"
    ]
  },
  "risk_analysis": {
    "overall_risk_level": "HIGH",
    "risk_recommendation": "High-risk issues must be resolved before production deployment",
    "risk_summary": {
      "high_risks": 2,
      "medium_risks": 2,
      "low_risks": 0
    },
    "identified_risks": [
      {
        "risk_category": "Data Integrity",
        "risk_level": "HIGH",
        "description": "3 critical data integrity issues identified",
        "impact": "Inaccurate dashboard reporting, incorrect clinical decision support",
        "likelihood": "HIGH",
        "mitigation": "Address all critical issues before production deployment"
      },
      {
        "risk_category": "Data Completeness",
        "risk_level": "HIGH",
        "description": "67 NHS trusts missing from database",
        "impact": "Incomplete national NHS performance picture",
        "likelihood": "CERTAIN",
        "mitigation": "Complete migration of all trust data"
      },
      {
        "risk_category": "Data Accuracy",
        "risk_level": "MEDIUM",
        "description": "Mathematical inconsistencies in 32.9% of calculations",
        "impact": "Incorrect performance metrics and trend analysis",
        "likelihood": "MEDIUM",
        "mitigation": "Review and fix data transformation algorithms"
      },
      {
        "risk_category": "Performance Standards",
        "risk_level": "MEDIUM",
        "description": "Very low A&E 4-hour standard compliance (20.9%)",
        "impact": "May indicate data quality issues or system-wide performance problems",
        "likelihood": "MEDIUM",
        "mitigation": "Validate A&E data collection and processing procedures"
      }
    ]
  },
  "recommendations": {
    "strategic_recommendations": [
      {
        "priority": "HIGH",
        "category": "Data Migration",
        "recommendation": "Complete migration of 67 missing NHS trusts to ensure comprehensive national coverage",
        "timeline": "1-2 weeks"
      },
      {
        "priority": "HIGH",
        "category": "Data Quality",
        "recommendation": "Implement comprehensive data validation rules in transformation pipeline to ensure mathematical consistency",
        "timeline": "2-3 weeks"
      }
    ],
    "categorized_recommendations": {
      "immediate_actions": [
        {
          "source_phase": "phase1",
          "recommendation": "\ud83d\udfe1 Warning issues found - review before proceeding to Phase 2",
          "priority": "MEDIUM"
        },
        {
          "source_phase": "phase2",
          "recommendation": "\ud83d\udd34 Critical database migration issues found - requires immediate attention",
          "priority": "HIGH"
        },
        {
          "source_phase": "phase3",
          "recommendation": "\ud83d\udd34 Critical business logic violations found - requires data quality review",
          "priority": "HIGH"
        }
      ],
      "data_quality_improvements": [
        {
          "source_phase": "phase1",
          "recommendation": "Consider data quality improvements for better accuracy",
          "priority": "LOW"
        },
        {
          "source_phase": "phase2",
          "recommendation": "Review data transformation pipeline for systematic errors",
          "priority": "LOW"
        },
        {
          "source_phase": "phase3",
          "recommendation": "Review data transformation and validation processes",
          "priority": "LOW"
        },
        {
          "source_phase": "phase3",
          "recommendation": "Review mathematical calculations in data transformation",
          "priority": "LOW"
        }
      ],
      "system_enhancements": [
        {
          "source_phase": "phase3",
          "recommendation": "Implement additional business rule checks in data pipeline",
          "priority": "LOW"
        }
      ],
      "process_improvements": [
        {
          "source_phase": "phase2",
          "recommendation": "Verify all source data is being processed correctly",
          "priority": "LOW"
        }
      ],
      "monitoring_and_validation": []
    },
    "total_recommendations": 9,
    "high_priority_count": 2
  },
  "action_plan": {
    "action_items": [
      {
        "priority": 1,
        "action": "Address Critical Data Integrity Issues",
        "description": "Resolve 3 critical issues identified across all test phases",
        "timeline": "1 week",
        "owner": "Data Engineering Team",
        "success_criteria": "Zero critical issues in re-testing"
      },
      {
        "priority": 2,
        "action": "Complete Database Migration",
        "description": "Migrate remaining 67 NHS trusts and missing time periods",
        "timeline": "1-2 weeks",
        "owner": "Data Migration Team",
        "success_criteria": "100% trust and period coverage in database"
      },
      {
        "priority": 3,
        "action": "Improve Mathematical Consistency",
        "description": "Fix calculation errors and implement validation rules",
        "timeline": "2 weeks",
        "owner": "Data Quality Team",
        "success_criteria": ">95% mathematical consistency rate"
      },
      {
        "priority": 4,
        "action": "Implement Data Quality Monitoring",
        "description": "Set up automated data quality checks and alerting",
        "timeline": "3 weeks",
        "owner": "Data Platform Team",
        "success_criteria": "Automated quality monitoring operational"
      },
      {
        "priority": 5,
        "action": "Comprehensive Re-testing",
        "description": "Re-run complete test suite after fixes are implemented",
        "timeline": "1 week",
        "owner": "QA Team",
        "success_criteria": "All test phases pass with <5% warning rate"
      }
    ],
    "timeline_summary": {
      "immediate_actions_1_2_weeks": 2,
      "short_term_actions_2_4_weeks": 2,
      "estimated_total_timeline": "4-6 weeks for full resolution"
    },
    "go_live_recommendation": "HOLD"
  },
  "appendices": {
    "test_methodology": {
      "phase1_methodology": "Source data verification using file system validation and CSV parsing",
      "phase2_methodology": "Database integrity testing using Supabase API and statistical sampling",
      "phase3_methodology": "Business logic validation using NHS performance standards and mathematical verification"
    },
    "technical_specifications": {
      "data_sources": [
        "unified_monthly_data_enhanced.csv (1,816 records, 271 columns)",
        "Supabase trust_metrics table",
        "Raw NHS England data files (A&E, RTT, Diagnostics)"
      ],
      "test_sample_sizes": {
        "transformation_accuracy": "25 randomly selected records",
        "jsonb_structure": "50 database records",
        "business_rules": "Full dataset validation"
      }
    },
    "data_dictionary": {
      "key_fields": {
        "trust_code": "3-character NHS trust identifier",
        "period": "YYYY-MM-DD format reporting period",
        "rtt_data": "JSONB field containing RTT performance metrics",
        "ae_data": "JSONB field containing A&E performance metrics"
      }
    },
    "performance_benchmarks": {
      "rtt_18_week_target": "92% within 18 weeks",
      "rtt_current_compliance": "4.8%",
      "ae_4_hour_target": "95% within 4 hours",
      "ae_current_compliance": "20.9%"
    }
  }
}